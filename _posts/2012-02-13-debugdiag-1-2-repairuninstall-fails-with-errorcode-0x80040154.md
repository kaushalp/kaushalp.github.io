---
id: 52
title: DebugDiag 1.2 repair/uninstall fails with ErrorCode 0x80040154
date: 2012-02-13T18:33:05+00:00
author: kaushal
layout: post
guid: https://blogs.msdn.microsoft.com/kaushal/2012/02/13/debugdiag-1-2-repairuninstall-fails-with-errorcode-0x80040154/
permalink: /2012/02/13/debugdiag-1-2-repairuninstall-fails-with-errorcode-0x80040154/
orig_url:
  - http://blogs.msdn.microsoft.com/b/kaushal/archive/2012/02/14/debugdiag-1-2-repair-uninstall-fails-with-errorcode-0x80040154.aspx
  - http://blogs.msdn.microsoft.com/b/kaushal/archive/2012/02/14/debugdiag-1-2-repair-uninstall-fails-with-errorcode-0x80040154.aspx
  - http://blogs.msdn.microsoft.com/b/kaushal/archive/2012/02/14/debugdiag-1-2-repair-uninstall-fails-with-errorcode-0x80040154.aspx
orig_site_id:
  - "13803"
  - "13803"
  - "13803"
orig_post_id:
  - "10267537"
  - "10267537"
  - "10267537"
orig_parent_id:
  - "10267537"
  - "10267537"
  - "10267537"
orig_application_key:
  - kaushal
  - kaushal
  - kaushal
orig_post_author_id:
  - "213737"
  - "213737"
  - "213737"
orig_post_author_username:
  - djkaushal
  - djkaushal
  - djkaushal
orig_post_author_created:
  - 2009-07-24 14:00:49.000
  - 2009-07-24 14:00:49.000
  - 2009-07-24 14:00:49.000
orig_is_approved:
  - "1"
  - "1"
  - "1"
orig_url_title:
  - http://blogs.msdn.com/b/kaushal/archive/2012/02/13/debugdiag-1-2-repairuninstall-fails-with-errorcode-0x80040154.aspx
  - http://blogs.msdn.com/b/kaushal/archive/2012/02/13/debugdiag-1-2-repairuninstall-fails-with-errorcode-0x80040154.aspx
  - http://blogs.msdn.com/b/kaushal/archive/2012/02/13/debugdiag-1-2-repairuninstall-fails-with-errorcode-0x80040154.aspx
orig_post_name:
  - debugdiag 1 2 repair uninstall fails with errorcode 0x80040154
  - debugdiag 1 2 repair uninstall fails with errorcode 0x80040154
  - debugdiag 1 2 repair uninstall fails with errorcode 0x80040154
orig_thread_id:
  - "797289"
  - "797289"
  - "797289"
orig_post_author_email:
  - kaushalp@microsoft.com
  - kaushalp@microsoft.com
  - kaushalp@microsoft.com
orig_attachment_count:
  - "0"
  - "0"
  - "0"
total_views:
  - "5897"
  - "5897"
  - "5897"
opengraph_tags:
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="DebugDiag 1.2 repair/uninstall fails with ErrorCode 0x80040154" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/kaushal/2012/02/13/debugdiag-1-2-repairuninstall-fails-with-errorcode-0x80040154/" />
    <meta property="og:site_name" content="Unleashed" />
    <meta property="og:description" content="Today I got a interesting issue to work with. While working on a issue I ran into a corrupt installation of DebugDiag 1.2. Whenever we tried installing or uninstalling it it threw the following error: so I ran a check to see what that error code meant. Here is the output: C:&gt;err 0x80040154 # for..." />
    <meta property="og:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/5852.image_thumb_2E96042A.png" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="DebugDiag 1.2 repair/uninstall fails with ErrorCode 0x80040154" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/kaushal/2012/02/13/debugdiag-1-2-repairuninstall-fails-with-errorcode-0x80040154/" />
    <meta name="twitter:description" content="Today I got a interesting issue to work with. While working on a issue I ran into a corrupt installation of DebugDiag 1.2. Whenever we tried installing or uninstalling it it threw the following error: so I ran a check to see what that error code meant. Here is the output: C:&gt;err 0x80040154 # for..." />
    <meta name="twitter:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/5852.image_thumb_2E96042A.png" />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="DebugDiag 1.2 repair/uninstall fails with ErrorCode 0x80040154" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/kaushal/2012/02/13/debugdiag-1-2-repairuninstall-fails-with-errorcode-0x80040154/" />
    <meta property="og:site_name" content="Unleashed" />
    <meta property="og:description" content="Today I got a interesting issue to work with. While working on a issue I ran into a corrupt installation of DebugDiag 1.2. Whenever we tried installing or uninstalling it it threw the following error: so I ran a check to see what that error code meant. Here is the output: C:&gt;err 0x80040154 # for..." />
    <meta property="og:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/5852.image_thumb_2E96042A.png" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="DebugDiag 1.2 repair/uninstall fails with ErrorCode 0x80040154" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/kaushal/2012/02/13/debugdiag-1-2-repairuninstall-fails-with-errorcode-0x80040154/" />
    <meta name="twitter:description" content="Today I got a interesting issue to work with. While working on a issue I ran into a corrupt installation of DebugDiag 1.2. Whenever we tried installing or uninstalling it it threw the following error: so I ran a check to see what that error code meant. Here is the output: C:&gt;err 0x80040154 # for..." />
    <meta name="twitter:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/5852.image_thumb_2E96042A.png" />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="DebugDiag 1.2 repair/uninstall fails with ErrorCode 0x80040154" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/kaushal/2012/02/13/debugdiag-1-2-repairuninstall-fails-with-errorcode-0x80040154/" />
    <meta property="og:site_name" content="Unleashed" />
    <meta property="og:description" content="Today I got a interesting issue to work with. While working on a issue I ran into a corrupt installation of DebugDiag 1.2. Whenever we tried installing or uninstalling it it threw the following error: so I ran a check to see what that error code meant. Here is the output: C:&gt;err 0x80040154 # for..." />
    <meta property="og:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/5852.image_thumb_2E96042A.png" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="DebugDiag 1.2 repair/uninstall fails with ErrorCode 0x80040154" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/kaushal/2012/02/13/debugdiag-1-2-repairuninstall-fails-with-errorcode-0x80040154/" />
    <meta name="twitter:description" content="Today I got a interesting issue to work with. While working on a issue I ran into a corrupt installation of DebugDiag 1.2. Whenever we tried installing or uninstalling it it threw the following error: so I ran a check to see what that error code meant. Here is the output: C:&gt;err 0x80040154 # for..." />
    <meta name="twitter:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/5852.image_thumb_2E96042A.png" />
    
categories:
  - Uncategorized
---
<font size="2" face="Segoe UI">Today I got a interesting issue to work with. While working on a issue I ran into a corrupt installation of DebugDiag 1.2. Whenever we tried installing or uninstalling it it threw the following error:</font>

<font size="2" face="Segoe UI"></font> 

<a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/1667.image_6D97AA92.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/1667.image_5F00_6D97AA92.png"><font size="2" face="Segoe UI"><img title="image" style="margin-right: auto; margin-left: auto; float: none; display: block;" alt="image" src="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/5852.image_thumb_2E96042A.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/5852.image_5F00_thumb_5F00_2E96042A.png" width="455" height="176" /></font></a>

<font size="2" face="Segoe UI"></font> 

<font size="2" face="Segoe UI">so I ran a check to see what that error code meant. Here is the output:</font>

<font size="2" face="Segoe UI"></font> 

<table cellspacing="0" cellpadding="2" width="400" border="3" frame="border">
  <font size="2" face="Segoe UI"></font> </p> 
  
  <tr>
    <font size="2" face="Segoe UI"></font> </p> 
    
    <td style="background: rgb(110, 106, 107); height: 15pt; padding-top: 0in; padding-right: 5.4pt;" valign="top" width="400">
      <font size="2" face="Segoe UI"></font> </p> 
      
      <p>
        <font size="2" face="Courier New">C:\>err 0x80040154 <br /># for hex 0x80040154 / decimal -2147221164 : <br />DIERR_DEVICENOTREG dinput.h <br />STIERR_DEVICENOTREG stierr.h <br />REGDB_E_CLASSNOTREG winerror.h <br /><strong><font style="background-color: rgb(255, 255, 0);"># Class not registered</font></strong> <br /># 3 matches found for "0x80040154"</font>
      </p>
      
      <p>
        <font size="2" face="Segoe UI"></font></td> 
        
        <p>
          <font size="2" face="Segoe UI"></font></tr> 
          
          <p>
            <font size="2" face="Segoe UI"></font></tbody> </table> 
            
            <p>
              <font size="2" face="Segoe UI"></font>
            </p>
            
            <p>
              <font size="2" face="Segoe UI">I kept clicking on “OK” button only to see it prompt me again. The only way to kill it was to go to the task manager.</font>
            </p>
            
            <p>
              <font size="2" face="Segoe UI"></font>
            </p>
            
            <ol>
              <font size="2" face="Segoe UI"></font> </p> 
              
              <li>
                <font size="2" face="Segoe UI">Under Applications tab right click DebugDiag and select “<strong>Go To Process</strong>” </font>
              </li>
              <p>
                <font size="2" face="Segoe UI"></font>
              </p>
              
              <li>
                <font size="2" face="Segoe UI">This took me to DebugDiag.exe </font>
              </li>
              <p>
                <font size="2" face="Segoe UI"></font>
              </p>
              
              <li>
                <font size="2" face="Segoe UI">Right click the process and select either “<strong>End Process</strong>” or “<strong>End Process Tree</strong>” </font>
              </li>
              <p>
                <font size="2" face="Segoe UI"></font></ol> 
                
                <p>
                  <font size="2" face="Segoe UI"></font>
                </p>
                
                <p>
                  <font size="2" face="Segoe UI">I was stuck in this awful situation where I had to fix this installation issue. Everyone knows how painful troubleshooting these issues could be.</font>
                </p>
                
                <p>
                  <font size="2" face="Segoe UI"></font>
                </p>
                
                <p>
                  <font size="2" face="Segoe UI">Instead of wasting time trying to think what to do next, I pinged my colleague <strong>Mourad</strong>. <img class="wlEmoticon wlEmoticon-smile" style="style" alt="Smile" src="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/4863.wlEmoticon-smile_07B7C81D.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/4863.wlEmoticon_2D00_smile_5F00_07B7C81D.png" /> He was my saviour for the day. He suggested me to go through the following blog link:</font>
                </p>
                
                <p>
                  <font size="2" face="Segoe UI"></font>
                </p>
                
                <p>
                  <a title="http://blogs.msdn.com/b/astebner/archive/2011/11/23/10241056.aspx" href="http://blogs.msdn.com/b/astebner/archive/2011/11/23/10241056.aspx"><font size="2" face="Segoe UI">http://blogs.msdn.com/b/astebner/archive/2011/11/23/10241056.aspx</font></a>
                </p>
                
                <p>
                  <font size="2" face="Segoe UI"></font>
                </p>
                
                <p>
                  <font size="2" face="Segoe UI">I am not to going to discuss the capabilities of this tool. So, here I was with this link. As there the server didn’t have direct access to internet, we had to download the portable fix it content on another machine and then copy it on to the server and launch it from there.</font>
                </p>
                
                <p>
                  <font size="2" face="Segoe UI"></font>
                </p>
                
                <p>
                  <font size="2" face="Segoe UI">This was the first time I was using this tool. So we were supposed to go to the URL:</font>
                </p>
                
                <p>
                  <font size="2" face="Segoe UI"></font>
                </p>
                
                <p>
                  <a title="http://support.microsoft.com/mats/Program_Install_and_Uninstall" href="http://support.microsoft.com/mats/Program_Install_and_Uninstall"><font size="2" face="Segoe UI">http://support.microsoft.com/mats/Program_Install_and_Uninstall</font></a>
                </p>
                
                <p>
                  <font size="2" face="Segoe UI"></font>
                </p>
                
                <p>
                  <font size="2" face="Segoe UI">We had to click on a small link below the Run buttton which read “<strong><u>Advanced-Download to run on a different or disconnected computer</u></strong>”. This would expand the link and provide us a Download button.</font>
                </p>
                
                <p>
                  <font size="2" face="Segoe UI"></font>
                </p>
                
                <p>
                  <font size="2" face="Segoe UI">Now we downloaded the file called “<strong>MicrosoftFixit-protable.exe</strong>” and ran it. It downloaded all the contents into a single folder. We copied this folder on to the server and ran it from there.</font>
                </p>
                
                <p>
                  <font size="2" face="Segoe UI"></font>
                </p>
                
                <ul>
                  <font size="2" face="Segoe UI"></font> </p> 
                  
                  <li>
                    <font size="2" face="Segoe UI">Ran the "<strong>Launch Fix it.exe</strong>".</font>
                  </li>
                  <p>
                    <font size="2" face="Segoe UI"></font>
                  </p>
                  
                  <li>
                    <font size="2" face="Segoe UI">Selected "<strong>All Problem areas</strong>" and clicked on "<strong>Run Now</strong>" for "<strong>Fix problems with programs that can&#8217;t be installed or uninstalled</strong>".</font>
                  </li>
                  <p>
                    <font size="2" face="Segoe UI"></font>
                  </p>
                  
                  <li>
                    <font size="2" face="Segoe UI">Selected "<strong>Debug Diagnostics 1.2</strong>" from the given list and clicked on Next.</font>
                  </li>
                  <p>
                    <font size="2" face="Segoe UI"></font>
                  </p>
                  
                  <li>
                    <font size="2" face="Segoe UI">Clicked on "<strong>Yes, try uninstall</strong>"</font>
                  </li>
                  <p>
                    <font size="2" face="Segoe UI"></font></ul> 
                    
                    <p>
                      <font size="2" face="Segoe UI"></font>
                    </p>
                    
                    <p>
                      <font size="2" face="Segoe UI">I thought I was done as this <strong>Fixit</strong> tool would take care of it. But alas, it again threw the same error prompt.</font>
                    </p>
                    
                    <p>
                      <font size="2" face="Segoe UI"></font>
                    </p>
                    
                    <p>
                      <a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/7103.image_6730886A.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/7103.image_5F00_6730886A.png"><font size="2" face="Segoe UI"><img title="image" style="border: 0px currentcolor; padding-top: 0px; padding-right: 0px; padding-left: 0px; margin-right: auto; margin-left: auto; float: none; display: block; background-image: none;" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/8171.image_thumb_32AFB622.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/8171.image_5F00_thumb_5F00_32AFB622.png" width="538" height="382" /></font></a>
                    </p>
                    
                    <p>
                      <font size="2" face="Segoe UI"></font>
                    </p>
                    
                    <p>
                      <font size="2" face="Segoe UI">It was the same behavior. Clicking on “<strong>OK</strong>” never really helped, the issue still exists. However, when I killed the DebugDiag.exe process via the task manager, the uninstallation completed.</font>
                    </p>
                    
                    <p>
                      <font size="2" face="Segoe UI"></font>
                    </p>
                    
                    <p>
                      <font size="2" face="Segoe UI">Yo-hoooooooo! DebugDiag is uninstalled successfully. Now I could install it again with no issues.</font>
                    </p>
                    
                    <p>
                      <font size="2" face="Segoe UI"></font>
                    </p>
                    
                    <p>
                      <font size="2" face="Segoe UI">Phew! That was quick, otherwise it could have been more painful. <img class="wlEmoticon wlEmoticon-winkingsmile" style="style" alt="Winking smile" src="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/8640.wlEmoticon-winkingsmile_3CB43180.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/8640.wlEmoticon_2D00_winkingsmile_5F00_3CB43180.png" /></font>
                    </p>
                    
                    <p>
                      <font size="2" face="Segoe UI"></font>
                    </p>
                    
                    <p>
                      <font size="2" face="Segoe UI">Hope this article helps someone who runs into this issue.</font>
                    </p>
                    
                    <p>
                      <font size="2" face="Segoe UI"></font>
                    </p>