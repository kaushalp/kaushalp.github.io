---
id: 387
title: 'POODLE Vulnerability: Padding Oracle on Downgraded Legacy Encryption'
date: 2014-10-22T01:15:00+00:00
author: kaushal
layout: post
guid: https://blogs.msdn.microsoft.com/kaushal/2014/10/22/poodle-vulnerability-padding-oracle-on-downgraded-legacy-encryption/
permalink: /2014/10/22/poodle-vulnerability-padding-oracle-on-downgraded-legacy-encryption/
orig_url:
  - http://blogs.msdn.microsoft.com/b/kaushal/archive/2014/10/22/poodle-vulnerability-padding-oracle-on-downgraded-legacy-encryption.aspx
  - http://blogs.msdn.microsoft.com/b/kaushal/archive/2014/10/22/poodle-vulnerability-padding-oracle-on-downgraded-legacy-encryption.aspx
  - http://blogs.msdn.microsoft.com/b/kaushal/archive/2014/10/22/poodle-vulnerability-padding-oracle-on-downgraded-legacy-encryption.aspx
orig_site_id:
  - "13803"
  - "13803"
  - "13803"
orig_post_id:
  - "10566476"
  - "10566476"
  - "10566476"
orig_parent_id:
  - "10566476"
  - "10566476"
  - "10566476"
orig_application_key:
  - kaushal
  - kaushal
  - kaushal
orig_post_author_id:
  - "213737"
  - "213737"
  - "213737"
orig_post_author_username:
  - djkaushal
  - djkaushal
  - djkaushal
orig_post_author_created:
  - 2009-07-24 14:00:49.000
  - 2009-07-24 14:00:49.000
  - 2009-07-24 14:00:49.000
orig_is_approved:
  - "1"
  - "1"
  - "1"
orig_url_title:
  - http://blogs.msdn.com/b/kaushal/archive/2014/10/22/poodle-vulnerability-padding-oracle-on-downgraded-legacy-encryption.aspx
  - http://blogs.msdn.com/b/kaushal/archive/2014/10/22/poodle-vulnerability-padding-oracle-on-downgraded-legacy-encryption.aspx
  - http://blogs.msdn.com/b/kaushal/archive/2014/10/22/poodle-vulnerability-padding-oracle-on-downgraded-legacy-encryption.aspx
orig_post_name:
  - poodle vulnerability padding oracle on downgraded legacy encryption
  - poodle vulnerability padding oracle on downgraded legacy encryption
  - poodle vulnerability padding oracle on downgraded legacy encryption
orig_thread_id:
  - "880877"
  - "880877"
  - "880877"
orig_post_author_email:
  - kaushalp@microsoft.com
  - kaushalp@microsoft.com
  - kaushalp@microsoft.com
orig_attachment_count:
  - "0"
  - "0"
  - "0"
total_views:
  - "4753"
  - "4753"
  - "4753"
opengraph_tags:
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="POODLE Vulnerability: Padding Oracle on Downgraded Legacy Encryption" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/kaushal/2014/10/22/poodle-vulnerability-padding-oracle-on-downgraded-legacy-encryption/" />
    <meta property="og:site_name" content="Unleashed" />
    <meta property="og:description" content="INTRODUCTION POODLE abbreviates to Padding Oracle On Downgraded Legacy Encryption. This vulnerability was discovered by Bodo Möller, Thai Duong &amp; Krzysztof Kotowicz from the GOOGLE security team and published here. I&#8217;m using the information published in this article as a reference for this blog post. This vulnerability has been listed in NVD; here is the..." />
    <meta property="og:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/1055.110414_0336_POODLEVulne1.png" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="POODLE Vulnerability: Padding Oracle on Downgraded Legacy Encryption" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/kaushal/2014/10/22/poodle-vulnerability-padding-oracle-on-downgraded-legacy-encryption/" />
    <meta name="twitter:description" content="INTRODUCTION POODLE abbreviates to Padding Oracle On Downgraded Legacy Encryption. This vulnerability was discovered by Bodo Möller, Thai Duong &amp; Krzysztof Kotowicz from the GOOGLE security team and published here. I&#8217;m using the information published in this article as a reference for this blog post. This vulnerability has been listed in NVD; here is the..." />
    <meta name="twitter:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/1055.110414_0336_POODLEVulne1.png" />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="POODLE Vulnerability: Padding Oracle on Downgraded Legacy Encryption" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/kaushal/2014/10/22/poodle-vulnerability-padding-oracle-on-downgraded-legacy-encryption/" />
    <meta property="og:site_name" content="Unleashed" />
    <meta property="og:description" content="INTRODUCTION POODLE abbreviates to Padding Oracle On Downgraded Legacy Encryption. This vulnerability was discovered by Bodo Möller, Thai Duong &amp; Krzysztof Kotowicz from the GOOGLE security team and published here. I&#8217;m using the information published in this article as a reference for this blog post. This vulnerability has been listed in NVD; here is the..." />
    <meta property="og:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/1055.110414_0336_POODLEVulne1.png" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="POODLE Vulnerability: Padding Oracle on Downgraded Legacy Encryption" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/kaushal/2014/10/22/poodle-vulnerability-padding-oracle-on-downgraded-legacy-encryption/" />
    <meta name="twitter:description" content="INTRODUCTION POODLE abbreviates to Padding Oracle On Downgraded Legacy Encryption. This vulnerability was discovered by Bodo Möller, Thai Duong &amp; Krzysztof Kotowicz from the GOOGLE security team and published here. I&#8217;m using the information published in this article as a reference for this blog post. This vulnerability has been listed in NVD; here is the..." />
    <meta name="twitter:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/1055.110414_0336_POODLEVulne1.png" />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="POODLE Vulnerability: Padding Oracle on Downgraded Legacy Encryption" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/kaushal/2014/10/22/poodle-vulnerability-padding-oracle-on-downgraded-legacy-encryption/" />
    <meta property="og:site_name" content="Unleashed" />
    <meta property="og:description" content="INTRODUCTION POODLE abbreviates to Padding Oracle On Downgraded Legacy Encryption. This vulnerability was discovered by Bodo Möller, Thai Duong &amp; Krzysztof Kotowicz from the GOOGLE security team and published here. I&#8217;m using the information published in this article as a reference for this blog post. This vulnerability has been listed in NVD; here is the..." />
    <meta property="og:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/1055.110414_0336_POODLEVulne1.png" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="POODLE Vulnerability: Padding Oracle on Downgraded Legacy Encryption" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/kaushal/2014/10/22/poodle-vulnerability-padding-oracle-on-downgraded-legacy-encryption/" />
    <meta name="twitter:description" content="INTRODUCTION POODLE abbreviates to Padding Oracle On Downgraded Legacy Encryption. This vulnerability was discovered by Bodo Möller, Thai Duong &amp; Krzysztof Kotowicz from the GOOGLE security team and published here. I&#8217;m using the information published in this article as a reference for this blog post. This vulnerability has been listed in NVD; here is the..." />
    <meta name="twitter:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/1055.110414_0336_POODLEVulne1.png" />
    
categories:
  - Uncategorized
---
<div>
  <table style="border-collapse:collapse; background: #0070c0" border="0">
    <colgroup> <col style="width:624px"/></colgroup> <tr style="height: 46px">
      <td vAlign="middle" style="padding-left: 7px; padding-right: 7px">
        <p>
          <span style="color:white; font-family:Segoe UI; font-size:16pt"><strong>INTRODUCTION</strong></span>
        </p>
      </td>
    </tr>
  </table>
</div>

<span style="font-family:Segoe UI"><span style="font-size:10pt"><strong>POODLE</strong> abbreviates to </span><span style="font-size:12pt"><strong>P</strong></span><span style="font-size:10pt">adding </span><span style="font-size:12pt"><strong>O</strong></span><span style="font-size:10pt">racle </span><span style="font-size:12pt"><strong>O</strong></span><span style="font-size:10pt">n </span><span style="font-size:12pt"><strong>D</strong></span><span style="font-size:10pt">owngraded </span><span style="font-size:12pt"><strong>L</strong></span><span style="font-size:10pt">egacy </span><span style="font-size:12pt"><strong>E</strong></span><span style="font-size:10pt">ncryption. This vulnerability was discovered by <strong>Bodo Möller</strong>, <strong>Thai Duong</strong> & <strong>Krzysztof Kotowicz</strong> from the <strong>GOOGLE</strong> security team and published <a href="https://www.openssl.org/~bodo/ssl-poodle.pdf">here</a>. I&#8217;m using the information published in this article as a reference for this blog post. This vulnerability has been listed in <a href="http://nvd.nist.gov/"><strong>NVD</strong></a>; here is the link: <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566">CVE-2014-3566</a>. Microsoft also has released a security bulleting on this issue: <a href="https://technet.microsoft.com/library/security/3009008.aspx">https://technet.microsoft.com/library/security/3009008.aspx</a><br /> </span></span>

<span style="font-family:Segoe UI; font-size:10pt">As the name suggests, <strong>POODLE</strong> exploits the design flaws of the legacy cryptographic protocol <strong>SSL 3.0</strong>.<br /> </span>

  * <span style="font-family:Segoe UI; font-size:10pt"><strong>Secure Socket Layer 3.0 </strong>or<strong> SSL 3.0 </strong>is a legacy cryptographic protocol which is a predecessor to <strong>TLS</strong>. It is considered obsolete and insecure due to many flaws in its design. For more technical details refer <a href="https://tools.ietf.org/html/rfc6101">RFC 6101</a>.<br /> </span>
  * <span style="font-family:Segoe UI; font-size:10pt"><strong>Transport Layer Security </strong>or <strong>TLS</strong> is a successor to <strong>SSL</strong>. There were several security flaws and design issue in SSL which lead to development of <strong>TLS 1.0 (</strong>also sometimes referred to as<strong> SSL 3.1)</strong>. <strong>TLS 1.0</strong> provides a fall-back mechanism to <strong>SSL 3.0</strong> so that clients/servers which are not compatible with <strong>TLS</strong><br /> <strong>1.0</strong> can use <strong>SSL 3.0</strong>.<br /> </span>

<div style="margin-left: 55pt">
  <table style="border-collapse:collapse; background: #bdd6ee" border="0">
    <colgroup> <col style="width:425px"/></colgroup> <tr>
      <td style="padding-left: 7px; padding-right: 7px; border-top:  solid 1.5pt; border-left:  solid 1.5pt; border-bottom:  solid 1.5pt; border-right:  solid 1.5pt">
        <p>
          <span style="font-family:Segoe UI; font-size:10pt"><strong>NOTE: SSL 2.0 </strong>also<strong><br /> </strong>exists which is a predecessor to <strong>SSL 3.0</strong>. These are the version of SSL or TLS drafted till date:<br /> </span>
        </p>
        
        <ol>
          <li>
            <span style="font-family:Segoe UI; font-size:10pt">SSL 2.0<br /> </span>
          </li>
          <li>
            <span style="font-family:Segoe UI; font-size:10pt">SSL 3.0<br /> </span>
          </li>
          <li>
            <span style="font-family:Segoe UI; font-size:10pt">TLS 1.0 (version field 3.1)<br /> </span>
          </li>
          <li>
            <span style="font-family:Segoe UI; font-size:10pt">TLS 1.2 (version field 3.2)<br /> </span>
          </li>
          <li>
            <span style="font-family:Segoe UI; font-size:10pt">TLS 1.2 (version field 3.3)</span>
          </li>
        </ol>
      </td>
    </tr>
  </table>
</div>

<p style="margin-left: 36pt">
   
</p>

  * <span style="font-family:Segoe UI; font-size:10pt"><strong>Protocol Negotiation</strong> – The SSL/TLS protocol handshake allows the client and server to negotiate the latest protocol version common to the client and the server. If during negotiation if they fail to use TLS then they fall-back to <strong>SSL 3.0</strong>.<br /> </span>

<span style="color:#c00000; font-family:Segoe UI; font-size:10pt"><span style="background-color:yellow">The <strong>POODLE</strong> attack exploits the fall-back mechanism to downgrade a secure connection to <strong>SSL 3.0</strong> and then breaks the cryptographic security of <strong>SSL 3.0</strong> to steal sensitive data such as <strong>HTTP</strong> cookies, <strong>HTTP</strong> Authorization header contents etc.</span><br /> </span>

<div>
  <table style="border-collapse:collapse; background: #0070c0" border="0">
    <colgroup> <col style="width:629px"/></colgroup> <tr style="height: 44px">
      <td vAlign="middle" style="padding-left: 7px; padding-right: 7px">
        <p>
          <span style="color:white; font-family:Segoe UI; font-size:16pt"><strong>How does POODLE work?</strong></span>
        </p>
      </td>
    </tr>
  </table>
</div>

<span style="font-family:Segoe UI; font-size:10pt">To understand this attack knowledge of CBC mode encryption is required. Refer this post of mine to understand how this works: <a href="http://blogs.msdn.com/b/kaushal/archive/2011/10/03/taming-the-beast-browser-exploit-against-ssl-tls.aspx">http://blogs.msdn.com/b/kaushal/archive/2011/10/03/taming-the-beast-browser-exploit-against-ssl-tls.aspx</a><br /> </span>

<span style="font-family:Segoe UI; font-size:10pt"><strong>SSL handshake</strong>: <a href="http://blogs.msdn.com/b/kaushal/archive/2013/08/03/ssl-handshake-and-https-bindings-on-iis.aspx">http://blogs.msdn.com/b/kaushal/archive/2013/08/03/ssl-handshake-and-https-bindings-on-iis.aspx</a><br /> </span>

<span style="font-family:Segoe UI; font-size:10pt">Almost all of the clients that exist today support <strong>SSL 3.0</strong> and provide a fall-back mechanism from <strong>TLS 1.0</strong> to <strong>SSL 3.0</strong> (<em>This downgrade purely exists for backward compatibility for legacy clients/servers</em>). It uses this downgrade option to implement <strong>Man-in-the-Middle</strong> attack to exploit a vulnerability in <strong>SSL 3.0</strong>.<br /> </span>

<span style="font-size:10pt"><span style="font-family:Segoe UI">Many clients/servers have a fall-back mechanism to work with legacy server/clients. During the SSL handshake, the client offers the highest protocol version supported by it, if this is not supported on the server, then server responds with what is supported and re-attempts the handshake. However there is a problem with the fall-back mechanism from <strong>TLS 1.0</strong><br /> </span><span style="font-family:Wingdings">à</span><span style="font-family:Segoe UI"><br /> <strong>SSL 3.0</strong>. This fall-back can also be triggered by network glitches or by an attacker who resides in between client and the server.<br /> </span></span>

<span style="font-family:Segoe UI; font-size:10pt">Once the attacker has succeeded in downgrading the connection to <strong>SSL 3.0</strong>, he proceeds ahead. SSL 3.0 like any other protocol supports <strong>RC4 stream ciphers</strong> and <strong>block ciphers</strong> in <strong>CBC</strong> mode. <strong>RC4</strong> is considered to be not secure; refer this blog post to know why: <a href="http://blog.cryptographyengineering.com/2013/03/attack-of-week-rc4-is-kind-of-broken-in.html">http://blog.cryptographyengineering.com/2013/03/attack-of-week-rc4-is-kind-of-broken-in.html</a><br /> </span>

<span style="font-family:Segoe UI; font-size:10pt"><strong>On the security of RC4 in TLS & WPA</strong>: <a href="http://www.isg.rhul.ac.uk/tls/">http://www.isg.rhul.ac.uk/tls/</a><br /> </span>

<span style="font-family:Segoe UI; font-size:10pt">Also read this wiki article: <a href="http://en.wikipedia.org/wiki/RC4">http://en.wikipedia.org/wiki/RC4</a>. Refer to section <a href="http://en.wikipedia.org/wiki/RC4"><strong>Roos&#8217; biases and key reconstruction from permutation</strong></a><strong><br /> </strong>and<strong><br /> <a href="http://en.wikipedia.org/wiki/RC4">Biased outputs of the RC4</a></strong> which explains the problem in <strong>RC4</strong>.<br /> </span>

<span style="font-family:Segoe UI; font-size:10pt">Coming to the CBC mode encryption in SSL 3.0, it has a serious flaw. Its block cipher padding is not deterministic, and not covered by the <strong>MAC</strong> (Message Authentication Code). As a result of this the encrypted text is exposed to the <strong>Man-in-the-middle</strong> attack which uses oracle padding to retrieve the encrypted text. This has been well explained in the article I outlined earlier. Below, is a snippet of the <a href="https://www.openssl.org/~bodo/ssl-poodle.pdf">article from Google Security team</a> explaining the attack in detail:<br /> </span>

<div style="margin-left: 56pt">
  <table style="border-collapse:collapse" border="0">
    <colgroup> <col style="width:784px"/></colgroup> <tr>
      <td style="padding-left: 7px; padding-right: 7px; border-top:  solid 0.5pt; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt">
        <p>
          <span style="color:#c00000; font-size:10pt"><span style="font-family:Segoe UI"><span style="background-color:yellow">The most severe problem of CBC encryption in SSL 3.0 is that its block cipher padding is not deterministic, and not covered by the MAC (Message Authentication Code): thus the integrity of padding cannot be fully verified when decrypting</span>. <span style="color:black">Padding by 1 to L bytes (where L is the block size in bytes) is used to obtain an integral number of blocks before performing blockwise CBC (cipher-block chaining) encryption. The weakness is the easiest to exploit if there&#8217;s an entire block of padding; which (before encryption) consists of L-1 arbitrary bytes followed by a single byte of value L-1. To process an incoming ciphertext record <strong>C<sub>i</sub>…C<sub>n</sub></strong> also given an initialization vector <strong>C<sub></sub></strong> (where each <strong>C<sub>i</sub></strong> is one block), the recipient first determines <strong>P<sub>i</sub>… P<sub>n</sub></strong> as <strong>P<sub>i</sub> = D<sub>k</sub> (C<sub>i</sub>) </strong></span></span><span style="font-family:Cambria Math"><strong>⊕</strong></span><span style="color:black"><span style="font-family:Segoe UI"><strong> C<sub>i-1</sub></strong>, 1 (where <strong>D<sub>k</sub></strong> denotes block-cipher decryption using per-connection key <strong>K</strong>), then checks and removes the padding at the end and finally checks and removes a MAC. Now observe that if there&#8217;s a full block of padding and an attacker replaces Cn by any earlier ciphertext block C from the same encrypted stream, the ciphertext will still be accepted if <strong>D<sub>k</sub> (C<sub>i</sub>) </strong></span><span style="font-family:Cambria Math"><strong>⊕</strong></span><span style="font-family:Segoe UI"><strong> C<sub>n-1</sub></strong> happens to have <strong>L-1</strong> as its final byte, but will in all likelihood be rejected otherwise, giving rise to a padding oracle attack [tls-cbc].<br /> </span></span></span>
        </p>
        
        <p>
          <span style="color:black; font-family:Segoe UI; font-size:10pt">In the web setting, this <strong>SSL 3.0</strong> weakness can be exploited by a man-in-the middle attacker to decrypt &#8220;secure&#8221; HTTP cookies; using techniques from the BEAST attack (BEAST). To launch the <strong>POODLE</strong> attack (Padding Oracle On Downgraded Legacy Encryption), run a JavaScript agent on evil.com (or on <a href="http://examplecom">http://examplecom</a>) to get the victim&#8217;s browser to send cookie-bearing HTTPS requests to <a href="https://example.com">https://example.com</a>, and Intercept and modify the SSL records sent by the browser in such a way that there&#8217;s a non-negligible chance that example.com will accept the modified record. If the modified record is accepted, the attacker can decrypt one byte of the cookies.<br /> </span>
        </p>
        
        <p>
          <span style="color:black; font-family:Segoe UI; font-size:10pt">Assume that each block <strong>C</strong> has 16 bytes, <strong>C[0]…C[15]</strong>. (Eight-byte blocks can be handled similarly.) Also assume for now; that the size of the cookies is known. (Later we will show how to start the attack if it isn&#8217;t) The <strong>MAC</strong> size in SSL 3.0 CBC cipher suites is typically 20 bytes, so below the CBC layer, an encrypted POST request will look as follows:<br /> </span>
        </p>
        
        <p style="margin-left: 72pt">
          <span style="color:black; font-size:10pt"><span style="font-family:Courier New; background-color:yellow">POST</span><span style="font-family:Segoe UI; background-color:yellow"> /path </span><span style="font-family:Courier New; background-color:yellow">Cookie</span><span style="font-family:Segoe UI; background-color:yellow">: name=value… </span><span style="font-family:Courier New; background-color:yellow">\r\n\r\n</span><span style="font-family:Segoe UI"><span style="background-color:yellow">body || 20-byte MAC || padding</span><br /> </span></span>
        </p>
        
        <p>
          <span style="color:black; font-family:Segoe UI; font-size:10pt">The attacker controls both the request path and the request body, and thus can induce requests such that the following two conditions hold:<br /> </span>
        </p>
        
        <ul>
          <li>
            <span style="color:black; font-family:Segoe UI; font-size:10pt">The padding fills an entire block (encrypted into C<sub>n</sub>).<br /> </span>
          </li>
          <li>
            <span style="color:black; font-family:Segoe UI; font-size:10pt">The cookies&#8217; first as of-yet unknown byte appears as the final byte in an earlier block (encrypted into C<sub>i</sub>)<br /> </span>
          </li>
        </ul>
        
        <p>
          <span style="color:black; font-size:10pt"><span style="font-family:Segoe UI">The attacker then replaces C<sub>n</sub> by C<sub>i</sub> and forwards this modified SSL record to the server. Usually, the server will reject this record, and the attacker will simply try again with a new request. Occasionally (on average, once in 256 requests), the server will accept the modified record, and the attacker will conclude that <strong>D<sub>k</sub> (C<sub>i</sub>)[15] </strong></span><span style="font-family:Cambria Math"><strong>⊕</strong></span><span style="font-family:Segoe UI"><strong> C<sub>n-1</sub>[15]=15</strong>, and thus that <strong>P<sub>i</sub>[15] = 15</strong></span><strong><span style="font-family:Cambria Math">⊕ </span><span style="font-family:Segoe UI">C<sub>n-1</sub>[15] </span><span style="font-family:Cambria Math">⊕</span></strong><span style="font-family:Segoe UI"><strong> C<sub>i-1</sub>[15]</strong>. This reveals the cookies&#8217; first previously unknown byte. The attacker proceeds to the next byte by changing the sizes of request path and body simultaneously such that the request size stays the same but the position of the headers is shifted, continuing until it has decrypted as much of the cookies as desired. <span style="background-color:yellow">The expected overall effort is 256 <strong>SSL 3.0</strong> requests per byte.</span><br /> </span></span>
        </p>
        
        <p>
          <span style="color:black; font-size:10pt"><span style="font-family:Segoe UI">As the padding hides the exact size of the payload, the cookies&#8217; size is not immediately apparent, but inducing requests </span><span style="font-family:Courier New">GET /</span><span style="font-family:Segoe UI">, </span><span style="font-family:Courier New">GET /A</span><span style="font-family:Segoe UI">, </span><span style="font-family:Courier New">GET /AA</span><span style="font-family:Segoe UI">, … allows the attacker to observe at which point the block boundary gets crossed: after at most 16 such requests this will reveal the padding size and thus the size of the cookies. </span></span>
        </p>
      </td>
    </tr>
  </table>
</div>

<span style="font-family:Segoe UI; font-size:10pt">The attack is pretty much similar to <strong>BEAST</strong> as it uses the oracle padding attack. However unlike <strong>BEAST</strong> there is no work-around mechanism or a fix that can be deployed to fix this vulnerability in <strong>SSL 3.0</strong>.<br /> </span>

<div>
  <table style="border-collapse:collapse; background: #00863d" border="0">
    <colgroup> <col style="width:628px"/></colgroup> <tr style="height: 42px">
      <td vAlign="middle" style="padding-left: 7px; padding-right: 7px">
        <p>
          <span style="color:white; font-family:Segoe UI; font-size:16pt"><strong>Workaround/Solution</strong></span>
        </p>
      </td>
    </tr>
  </table>
</div>

<span style="font-family:Segoe UI; font-size:10pt">The attack works by establishing a secure connection using <strong>SSL 3.0</strong>. <span style="background-color:yellow">Therefore, one could simply disable the <strong>SSL 3.0</strong> protocol at their end to safeguard themselves against this attack.</span><br /> </span>

<span style="font-family:Segoe UI; font-size:10pt">However if the client/server supports only <strong>SSL 3.0</strong> then there is no workaround. The Google security team has submitted a draft which suggests the <strong>TLS_FALLBACK_SCSV</strong> mechanism to address the protocol downgrade problem. They have already implemented this in their own products. Read this article for more details: <a href="http://tools.ietf.org/html/draft-ietf-tls-downgrade-scsv-00">http://tools.ietf.org/html/draft-ietf-tls-downgrade-scsv-00</a><br /> </span>

<span style="font-family:Segoe UI; font-size:10pt">So to summarize, to protect against this attack one has to disable SSL 3.0 on the server/client. I will summarize the steps for doing this on <strong>IIS 6 </strong>and higher, <strong>Microsoft Azure Web Sites</strong>, <strong>Firefox</strong>, <strong>Chrome</strong> and <strong>IE</strong>.<br /> </span>

<span style="font-family:Segoe UI; font-size:14pt; text-decoration:underline"><strong>For IIS Web Server (version 6.0 and higher)<br /> </strong></span>

<p style="margin-left: 36pt">
  <span style="font-family:Segoe UI; font-size:10pt">Note that <strong>IIS</strong> relies on the cryptographic implementation provided by <strong>Windows</strong> (<strong>SChannel</strong>) for secure communication (<strong>HTTPS</strong>). So IIS uses the <strong>SChannel</strong> component to implement <strong>HTTPS</strong> communication with various clients.<br /> </span>
</p>

<ol style="margin-left: 72pt">
  <li>
    <span style="font-family:Segoe UI; font-size:10pt">Click <strong>Start</strong>, click <strong>Run</strong>, type <strong>regedit</strong>, and then click <strong>OK</strong>.<br /> </span>
  </li>
  <li>
    <div>
      <span style="font-family:Segoe UI; font-size:10pt">In Registry Editor, locate the following registry key (if not present you can create it)<br /> </span>
    </div>
    
    <p>
      <span style="font-family:Consolas; font-size:10pt"><strong>HKey_Local_Machine\System\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Server<br /> </strong></span>
    </p>
  </li>
  
  <li>
    <span style="font-family:Segoe UI; font-size:10pt">On the <strong>Edit</strong> menu, click <strong>Add</strong><br /> <strong>Value</strong>.<br /> </span>
  </li>
  <li>
    <span style="font-family:Segoe UI; font-size:10pt">In the <strong>Data</strong><br /> <strong>Type</strong> list, click <strong>DWORD</strong>.<br /> </span>
  </li>
  <li>
    <span style="font-family:Segoe UI; font-size:10pt">In the <strong>Value</strong><br /> <strong>Name</strong> box, type <strong>Enabled</strong>, and then click <strong>OK</strong>. <br /> </span>
  </li>
  <li>
    <span style="font-family:Segoe UI; font-size:10pt">Type <strong>00000000</strong> in Binary Editor to set the value of the new key equal to &#8220;<strong></strong>&#8220;.<br /> </span>
  </li>
  <li>
    <span style="font-family:Segoe UI; font-size:10pt">Click <strong>OK</strong>. Restart the computer.<br /> </span>
  </li>
</ol>

<div style="margin-left: 98pt">
  <table style="border-collapse:collapse; background: #bdd6ee" border="0">
    <colgroup> <col style="width:672px"/></colgroup> <tr>
      <td style="padding-left: 7px; padding-right: 7px; border-top:  solid 1.5pt; border-left:  solid 1.5pt; border-bottom:  solid 1.5pt; border-right:  solid 1.5pt">
        <p>
          <span style="font-family:Segoe UI; font-size:10pt"><strong>NOTE:</strong> the above is a server wide change and will affect all the server side components which use SCHANNEL.</span>
        </p>
      </td>
    </tr>
  </table>
</div>

<p style="margin-left: 36pt">
  <span style="font-family:Segoe UI; font-size:10pt">Another way to do this is:<br /> </span>
</p>

<ul style="margin-left: 72pt">
  <li>
    <span style="font-family:Segoe UI; font-size:10pt">Launch <strong>notepad.exe</strong><br /> </span>
  </li>
  <li>
    <span style="font-family:Segoe UI; font-size:10pt">Copy the below in to notepad:<br /> </span>
  </li>
</ul>

<div style="margin-left: 98pt">
  <table style="border-collapse:collapse; background: #bdd6ee" border="0">
    <colgroup> <col style="width:758px"/></colgroup> <tr>
      <td vAlign="middle" style="padding-left: 7px; padding-right: 7px; border-top:  solid 1.5pt; border-left:  solid 1.5pt; border-bottom:  solid 1.5pt; border-right:  solid 1.5pt">
        <p>
          <span style="font-family:Courier New; font-size:10pt">Windows Registry Editor Version 5.00<br />[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Server]<br />&#8220;Enabled&#8221;=dword:00000000</span>
        </p>
      </td>
    </tr>
  </table>
</div>

<ul style="margin-left: 72pt">
  <li>
    <span style="font-family:Segoe UI; font-size:10pt">Save the file as disablessl3.reg (<em>Note that the file extension is <strong>.reg</strong></em>)<br /> </span>
  </li>
  <li>
    <span style="font-family:Segoe UI; font-size:10pt">Double click this file.<br /> </span>
  </li>
  <li>
    <span style="font-family:Segoe UI; font-size:10pt">You would receive a prompt saying it is going to make changes to the registry. Click on <strong>OK</strong>.<br /> </span>
  </li>
  <li>
    <span style="font-family:Segoe UI; font-size:10pt">Restart the computer for the changes to take effect.<br /> </span>
  </li>
</ul>

<span style="font-family:Segoe UI; font-size:14pt; text-decoration:underline"><strong>For Microsoft Azure Web Sites<br /> </strong></span>

<p style="margin-left: 36pt">
  <span style="font-family:Segoe UI; font-size:10pt"><strong>SSL 3.0</strong> has been disabled by default for all sites running on <strong>Azure Websites</strong>. The product group has published a blog on how to disable this for <strong>Azure</strong><br /> <strong>VM</strong> and <strong>Cloud Services</strong>:<br /> </span>
</p>

<p style="margin-left: 36pt">
  <a href="http://azure.microsoft.com/blog/2014/10/19/how-to-disable-ssl-3-0-in-azure-websites-roles-and-virtual-machines/"><span style="font-family:Segoe UI; font-size:10pt">http://azure.microsoft.com/blog/2014/10/19/how-to-disable-ssl-3-0-in-azure-websites-roles-and-virtual-machines/</span></a><span style="font-family:Segoe UI; font-size:10pt"><br /> </span>
</p>

<span style="font-family:Segoe UI; font-size:14pt; text-decoration:underline"><strong>For Internet Explorer<br /> </strong></span>

<p style="margin-left: 36pt">
  <span style="font-family:Segoe UI; font-size:10pt">Similar to <strong>IIS</strong>, <strong>IE</strong> also uses the <strong>SChannel</strong> component of Windows for cryptography and encryption. However it uses the client component of <strong>SChannel</strong>. To disable <strong>SSL 3.0</strong> for IE follow the below instructions:<br /> </span>
</p>

<ol style="margin-left: 72pt">
  <li>
    <span style="font-family:Segoe UI; font-size:10pt">Launch <strong>Internet Explorer</strong>.<br /> </span>
  </li>
  <li>
    <span style="font-size:10pt"><span style="font-family:Segoe UI">Go to Tools </span><span style="font-family:Wingdings">à</span><span style="font-family:Segoe UI"><br /> <strong>Internet Options</strong><br /> </span><span style="font-family:Wingdings">à</span><span style="font-family:Segoe UI"><br /> <strong>Advanced</strong> tab.<br /> </span></span>
  </li>
  <li>
    <div>
      <span style="font-family:Segoe UI; font-size:10pt">Scroll down to the bottom and here you will find the protocol list for IE. Uncheck <strong>SSL 3.0</strong>.<br /> </span>
    </div>
    
    <p>
      <img src="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/1055.110414_0336_POODLEVulne1.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/1055.110414_5F00_0336_5F00_POODLEVulne1.png" alt="" /><span style="font-family:Segoe UI; font-size:10pt"><br /> </span>
    </p>
  </li>
  
  <li>
    <span style="font-family:Segoe UI; font-size:10pt">Click on OK and restart the browser for the changes to take effect.<br /> </span>
  </li>
</ol>

<span style="font-family:Segoe UI; font-size:14pt; text-decoration:underline"><strong>For Google Chrome<br /> </strong></span>

<p style="margin-left: 36pt">
  <span style="font-family:Segoe UI; font-size:10pt">Google Chrome will be removing support for SSL .30 completely in its upcoming versions. Read this for more details: <a href="http://googleonlinesecurity.blogspot.com.au/2014/10/this-poodle-bites-exploiting-ssl-30.html">http://googleonlinesecurity.blogspot.com.au/2014/10/this-poodle-bites-exploiting-ssl-30.html</a><br /> </span>
</p>

<ol style="margin-left: 72pt">
  <li>
    <span style="font-family:Segoe UI; font-size:10pt">Right click at your <strong>Chrome&#8217;s</strong> desktop icon and click on <strong>Properties</strong><br /> </span>
  </li>
  <li>
    <span style="font-size:10pt"><span style="font-family:Segoe UI">At the end of the <strong>target</strong> field enter:<br />&#8220;</span><span style="font-family:Courier New"><strong> &#8211;ssl-version-min=tls1</strong></span><span style="font-family:Segoe UI">&#8221; (<em>with space but without quotes</em>).<br /> </span></span>
  </li>
  <li>
    <div>
      <span style="font-family:Segoe UI; font-size:10pt">Click on <strong>Apply</strong> and then click on <strong>OK</strong>.<br /> </span>
    </div>
    
    <p>
      <img src="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/5661.110414_0336_POODLEVulne2.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/5661.110414_5F00_0336_5F00_POODLEVulne2.png" alt="" /><span style="font-family:Segoe UI; font-size:10pt"><br /> </span>
    </p>
  </li>
  
  <li>
    <span style="font-family:Segoe UI; font-size:10pt">Restart Chrome completely via the menu or with [<strong>Ctrl + Shift + Q</strong>]<br /> </span>
  </li>
</ol>

<span style="font-family:Segoe UI; font-size:14pt; text-decoration:underline"><strong>For Mozilla Firefox<br /> </strong></span>

<p style="margin-left: 36pt">
  <span style="font-family:Segoe UI; font-size:10pt">As per Mozilla security blog, SSL 3.0 will be disabled by default in <strong>Firefox v34</strong>, which will be released on <strong>Nov 25<sup>th</sup> 2014</strong>.<br /> </span>
</p>

<ol style="margin-left: 72pt">
  <li>
    <span style="font-family:Segoe UI; font-size:10pt">For users who cannot wait, Firefox has released <a href="https://addons.mozilla.org/en-US/firefox/addon/ssl-version-control/">SSL Version Control</a> Firefox extension to disable <strong>SSLv3</strong> immediately.<br /> </span>
  </li>
  <li>
    <div>
      <span style="font-family:Segoe UI; font-size:10pt">Click on the above link and click on <strong>Add to Firefox</strong> button.<br /> </span>
    </div>
    
    <p>
      <img src="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/4617.110414_0336_POODLEVulne3.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/4617.110414_5F00_0336_5F00_POODLEVulne3.png" alt="" /><span style="font-family:Segoe UI; font-size:10pt"><br /> </span>
    </p>
  </li>
  
  <li>
    <span style="font-family:Segoe UI; font-size:10pt">This doesn&#8217;t require a restart.<br /> </span>
  </li>
</ol>

<span style="font-family:Segoe UI; font-size:10pt">The above extension changes the <strong>security.tls.version.min</strong> to <strong>1</strong>. There are 2 keys which govern the SSL protocol for <strong>Firefox</strong>. They are:<br /> </span>

<ol style="margin-left: 72pt">
  <li>
    <span style="font-family:Segoe UI; font-size:10pt"><strong>security.tls.version.min </strong>specifies the minimum supported protocol version.<br /> </span>
  </li>
  <li>
    <span style="font-family:Segoe UI; font-size:10pt"><strong>security.tls.version.max</strong> specifies the maximum supported protocol version.<br /> </span>
  </li>
</ol>

<span style="font-family:Segoe UI; font-size:10pt">Both <strong>security.tls.version.min</strong> and <strong>security.tls.version.max</strong> currently range from <strong></strong> to <strong>3</strong>. If <strong>security.tls.version.min</strong> and <strong>security.tls.version.max</strong> are equal, only one protocol version will be supported. The behavior is undefined if <strong>security.tls.version.min</strong> is <em>larger</em> than the <strong>security.tls.version.max</strong> value.<br /> </span>

<div style="margin-left: 126pt">
  <table style="border-collapse:collapse" border="0">
    <colgroup> <col style="width:66px"/> <col style="width:197px"/></colgroup> <tr style="height: 20px; background: #0070c0">
      <td vAlign="middle" style="padding-left: 7px; padding-right: 7px; border-top:  solid #0070c0 1.5pt; border-left:  solid #0070c0 1.5pt; border-bottom:  solid #0070c0 1.5pt; border-right:  solid #0070c0 1.5pt">
        <p style="text-align: center">
          <span style="color:white; font-family:Segoe UI; font-size:10pt"><strong>Value</strong></span>
        </p>
      </td>
      
      <td vAlign="middle" style="padding-left: 7px; padding-right: 7px; border-top:  solid #0070c0 1.5pt; border-left:  none; border-bottom:  solid #0070c0 1.5pt; border-right:  solid #0070c0 1.5pt">
        <p style="text-align: center">
          <span style="color:white; font-family:Segoe UI; font-size:10pt"><strong>Protocol</strong></span>
        </p>
      </td>
    </tr>
    
    <tr style="height: 20px">
      <td vAlign="middle" style="background: white; padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  solid #0070c0 1.5pt; border-bottom:  solid #0070c0 1.5pt; border-right:  solid #0070c0 1.5pt">
        <p style="text-align: center">
          <span style="font-family:Segoe UI; font-size:10pt"><strong></strong></span>
        </p>
      </td>
      
      <td vAlign="middle" style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid #0070c0 1.5pt; border-right:  solid #0070c0 1.5pt">
        <p style="text-align: center">
          <span style="font-family:Segoe UI; font-size:10pt"><strong>SSL 3.0</strong></span>
        </p>
      </td>
    </tr>
    
    <tr style="height: 20px">
      <td vAlign="middle" style="background: white; padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  solid #0070c0 1.5pt; border-bottom:  solid #0070c0 1.5pt; border-right:  solid #0070c0 1.5pt">
        <p style="text-align: center">
          <span style="font-family:Segoe UI; font-size:10pt"><strong>1</strong></span>
        </p>
      </td>
      
      <td vAlign="middle" style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid #0070c0 1.5pt; border-right:  solid #0070c0 1.5pt">
        <p style="text-align: center">
          <span style="font-family:Segoe UI; font-size:10pt"><strong>TLS 1.0</strong></span>
        </p>
      </td>
    </tr>
    
    <tr style="height: 20px">
      <td vAlign="middle" style="background: white; padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  solid #0070c0 1.5pt; border-bottom:  solid #0070c0 1.5pt; border-right:  solid #0070c0 1.5pt">
        <p style="text-align: center">
          <span style="font-family:Segoe UI; font-size:10pt"><strong>2</strong></span>
        </p>
      </td>
      
      <td vAlign="middle" style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid #0070c0 1.5pt; border-right:  solid #0070c0 1.5pt">
        <p style="text-align: center">
          <span style="font-family:Segoe UI; font-size:10pt"><strong>TLS 1.1</strong></span>
        </p>
      </td>
    </tr>
    
    <tr style="height: 20px">
      <td vAlign="middle" style="background: white; padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  solid #0070c0 1.5pt; border-bottom:  solid #0070c0 1.5pt; border-right:  solid #0070c0 1.5pt">
        <p style="text-align: center">
          <span style="font-family:Segoe UI; font-size:10pt"><strong>3</strong></span>
        </p>
      </td>
      
      <td vAlign="middle" style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid #0070c0 1.5pt; border-right:  solid #0070c0 1.5pt">
        <p style="text-align: center">
          <span style="font-family:Segoe UI; font-size:10pt"><strong>TLS 1.2</strong></span>
        </p>
      </td>
    </tr>
  </table>
</div>

 

<span style="font-family:Segoe UI; font-size:10pt">You can access the above mentioned keys in Firefox by typing <strong>about:config</strong> in the address bar. Enter <strong>TLS</strong> in the search bar to retrieve <strong>TLS</strong> related settings.<br /> </span>

<p style="margin-left: 36pt">
  <img src="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/3051.110414_0336_POODLEVulne4.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/3051.110414_5F00_0336_5F00_POODLEVulne4.png" alt="" /><span style="font-family:Segoe UI; font-size:10pt"><br /> </span>
</p>

<div style="margin-left: 98pt">
  <table style="border-collapse:collapse; background: #bdd6ee" border="0">
    <colgroup> <col style="width:758px"/></colgroup> <tr>
      <td vAlign="middle" style="padding-left: 7px; padding-right: 7px; border-top:  solid #c00000 1.5pt; border-left:  solid #c00000 1.5pt; border-bottom:  solid #c00000 1.5pt; border-right:  solid #c00000 1.5pt">
        <p>
          <span style="font-family:Segoe UI; font-size:10pt"><strong>NOTE:</strong> Please refer Google, Firefox and other related browser documentation for detailed information on the corresponding browsers.</span>
        </p>
      </td>
    </tr>
  </table>
</div>

 

<span style="font-family:Segoe UI; font-size:10pt">Hope this article helps. Provide comments, for any corrections.</span>