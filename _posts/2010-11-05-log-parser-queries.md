---
id: 18
title: Log Parser Queries
date: 2010-11-05T21:15:38+00:00
author: kaushal
layout: post
guid: https://blogs.msdn.microsoft.com/kaushal/2010/11/05/log-parser-queries/
permalink: /2010/11/05/log-parser-queries/
orig_url:
  - http://blogs.msdn.microsoft.com/b/kaushal/archive/2010/11/06/log-parser-queries.aspx
  - http://blogs.msdn.microsoft.com/b/kaushal/archive/2010/11/06/log-parser-queries.aspx
  - http://blogs.msdn.microsoft.com/b/kaushal/archive/2010/11/06/log-parser-queries.aspx
orig_site_id:
  - "13803"
  - "13803"
  - "13803"
orig_post_id:
  - "10087025"
  - "10087025"
  - "10087025"
orig_parent_id:
  - "10087025"
  - "10087025"
  - "10087025"
orig_application_key:
  - kaushal
  - kaushal
  - kaushal
orig_post_author_id:
  - "213737"
  - "213737"
  - "213737"
orig_post_author_username:
  - djkaushal
  - djkaushal
  - djkaushal
orig_post_author_created:
  - 2009-07-24 14:00:49.000
  - 2009-07-24 14:00:49.000
  - 2009-07-24 14:00:49.000
orig_is_approved:
  - "1"
  - "1"
  - "1"
orig_url_title:
  - http://blogs.msdn.com/b/kaushal/archive/2010/11/05/log-parser-queries.aspx
  - http://blogs.msdn.com/b/kaushal/archive/2010/11/05/log-parser-queries.aspx
  - http://blogs.msdn.com/b/kaushal/archive/2010/11/05/log-parser-queries.aspx
orig_post_name:
  - log parser queries
  - log parser queries
  - log parser queries
orig_thread_id:
  - "739529"
  - "739529"
  - "739529"
orig_post_author_email:
  - kaushalp@microsoft.com
  - kaushalp@microsoft.com
  - kaushalp@microsoft.com
orig_attachment_count:
  - "0"
  - "0"
  - "0"
total_views:
  - "7227"
  - "7227"
  - "7227"
opengraph_tags:
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Log Parser Queries" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/kaushal/2010/11/05/log-parser-queries/" />
    <meta property="og:site_name" content="Unleashed" />
    <meta property="og:description" content="Log Parser is one of the most powerful tools available for parsing IIS logs. It can effectively parse GB’s of data in effective time. Below is the download link: Download Log Parser 2.2 These are the few Log parser queries using the command line interface. I have used&#160; it most of the time. I have..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Log Parser Queries" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/kaushal/2010/11/05/log-parser-queries/" />
    <meta name="twitter:description" content="Log Parser is one of the most powerful tools available for parsing IIS logs. It can effectively parse GB’s of data in effective time. Below is the download link: Download Log Parser 2.2 These are the few Log parser queries using the command line interface. I have used&#160; it most of the time. I have..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Log Parser Queries" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/kaushal/2010/11/05/log-parser-queries/" />
    <meta property="og:site_name" content="Unleashed" />
    <meta property="og:description" content="Log Parser is one of the most powerful tools available for parsing IIS logs. It can effectively parse GB’s of data in effective time. Below is the download link: Download Log Parser 2.2 These are the few Log parser queries using the command line interface. I have used&#160; it most of the time. I have..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Log Parser Queries" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/kaushal/2010/11/05/log-parser-queries/" />
    <meta name="twitter:description" content="Log Parser is one of the most powerful tools available for parsing IIS logs. It can effectively parse GB’s of data in effective time. Below is the download link: Download Log Parser 2.2 These are the few Log parser queries using the command line interface. I have used&#160; it most of the time. I have..." />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Log Parser Queries" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/kaushal/2010/11/05/log-parser-queries/" />
    <meta property="og:site_name" content="Unleashed" />
    <meta property="og:description" content="Log Parser is one of the most powerful tools available for parsing IIS logs. It can effectively parse GB’s of data in effective time. Below is the download link: Download Log Parser 2.2 These are the few Log parser queries using the command line interface. I have used&#160; it most of the time. I have..." />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Log Parser Queries" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/kaushal/2010/11/05/log-parser-queries/" />
    <meta name="twitter:description" content="Log Parser is one of the most powerful tools available for parsing IIS logs. It can effectively parse GB’s of data in effective time. Below is the download link: Download Log Parser 2.2 These are the few Log parser queries using the command line interface. I have used&#160; it most of the time. I have..." />
    
categories:
  - Uncategorized
---
<font size="2" face="Segoe UI">Log Parser is one of the most powerful tools available for parsing IIS logs. It can effectively parse GB’s of data in effective time. </font><font size="2" face="Segoe UI">Below is the download link:</font>

<a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=890cd06b-abf8-4c25-91b2-f8d975cf8c07&displaylang=en" target="_blank" rel="noopener noreferrer"><font size="2" face="Segoe UI">Download Log Parser 2.2</font></a>

<font size="2" face="Segoe UI"></font>

<font size="2" face="Segoe UI">These are the few Log parser queries using the command line interface. I have used&#160; it most of the time. I have used <strong>DataGrid</strong> as the output format. More details on the input and the output format can be found here: <a title="http://technet.microsoft.com/en-us/scriptcenter/dd919274.aspx" href="http://technet.microsoft.com/en-us/scriptcenter/dd919274.aspx"><font size="2" face="Segoe UI">http://technet.microsoft.com/en-us/scriptcenter/dd919274.aspx</font></a></font>

<font size="2" face="Segoe UI">Below are the different type of queries:</font>

<font size="2" face="Segoe UI"></font> 

**<u><font size="4" face="Segoe UI">Search for total number of static files that were requested:</font></u>**

<table cellspacing="0" cellpadding="2" width="600" border="1">
  <tr>
    <td valign="top" width="600">
      <p align="left">
        <font size="2" face="Courier New">LOGPARSER "SELECT count(*) as hits, sc-status, cs-uri-stem from <strong><font color="#ff0000"><Log File Path></font></strong> where cs-uri-stem not like &#8216;%.axd&#8217; and cs-uri-stem not like &#8216;%.ashx&#8217; and cs-uri-stem not like &#8216;%.aspx&#8217; and and cs-uri-stem not like &#8216;%.asmx&#8217; and cs-uri-stem not like &#8216;%.asp&#8217; and cs-uri-stem not like &#8216;%.dll&#8217; and cs-uri-stem not like &#8216;%.exe&#8217; group by sc-status, cs-uri-stem order by hits desc" -i:IISW3C -o:DataGrid -q:off</font>
      </p>
    </td>
  </tr>
  
  <tr>
    <td valign="top" width="600">
      <font size="2" face="Segoe UI">In the above query I am eliminating the dynamic files. We could add more dynamic files to the list above.</font>
    </td>
  </tr>
</table>

**<font size="3" face="Segoe UI"><u> <br /><font size="4">Total No. of Entries in the IIS logs:</font></u></font>**

   <font size="2" face="Segoe UI"></p> 

<table cellspacing="0" cellpadding="2" width="600" border="1">
  <tr>
    <td valign="top" width="600">
      <p align="left">
        <font size="2" face="Courier New">LOGPARSER "SELECT count(*) as hits from <font color="#ff0000"><strong><Log File Path></strong></font>" -i:IISW3C -o:DataGrid -q:off</font>
      </p>
    </td>
  </tr>
</table>

<p>
  </font>
</p>

<p>
  <strong><font face="Segoe UI"><u> <br /><font size="4">Dumping out entries based upon responses:</font></u></font></strong>
</p>

<p>
  <font size="2" face="Segoe UI"> </p> 
  
  <table cellspacing="0" cellpadding="2" width="600" border="1">
    <tr>
      <td valign="top" width="600">
        <p align="left">
          <font face="Courier New">LOGPARSER "SELECT count(*) as hits, sc-status from <strong><font color="#ff0000"><Log File Path></font></strong> GROUP BY sc-status order by hits desc" -i:IISW3C -o:DataGrid -q:off</font>
        </p>
      </td>
    </tr>
  </table>
  
  <p>
    </font>
  </p>
  
  <p>
    <strong><font size="4" face="Segoe UI"><u>Adding the requested resource (cs-uri-stem) to the above query:</u></font></strong><font size="2" face="Segoe UI">&#160; </font>
  </p>
  
  <table cellspacing="0" cellpadding="2" width="600" border="1">
    <tr>
      <td valign="top" width="600">
        <p align="left">
          <font size="2" face="Courier New">LOGPARSER "SELECT count(*) as hits, sc-status, cs-uri-stem from <strong><font color="#ff0000"><Log File Path></font></strong> GROUP BY cs-uri-stem, sc-status order by hits desc" -i:IISW3C -o:DataGrid -q:off</font>
        </p>
      </td>
    </tr>
  </table>
  
  <p>
    <font size="2" face="Segoe UI"></font>
  </p>
  
  <p>
    <strong><font face="Segoe UI"><u> <br /><font size="4">Client IP that was logged against a specific cs-host the most: <br /></font></u></font></strong><font size="2" face="Segoe UI"> </p> 
    
    <table cellspacing="0" cellpadding="2" width="600" border="1">
      <tr>
        <td valign="top" width="600">
          <p align="left">
            <font face="Courier New">LOGPARSER "SELECT count(*) as hits, c-ip, cs-host, sc-status from <strong><font color="#ff0000"><Log File Path></font></strong> where cs-host='<Host-Header>&#8217; GROUP BY c-ip, cs-host, sc-status order by hits desc" -i:IISW3C -o:DataGrid -q:off</font>
          </p>
        </td>
      </tr>
    </table>
    
    <p>
      </font><font size="2" face="Segoe UI">&#160; </font>
    </p>
    
    <p>
      <strong><u><font size="4" face="Segoe UI">Client IP that requested most no. of times:</font></u></strong>
    </p>
    
    <p>
      <font size="2" face="Segoe UI"> </p> 
      
      <table cellspacing="0" cellpadding="2" width="600" border="1">
        <tr>
          <td valign="top" width="600">
            <p align="left">
              <font face="Courier New">LOGPARSER "SELECT count(*) as hits, c-ip, cs-host, sc-status from <strong><font color="#ff0000"><Log File Path></font></strong> GROUP BY c-ip, cs-host, sc-status order by hits desc" -i:IISW3C -o:DataGrid -q:off</font>
            </p>
          </td>
        </tr>
      </table>
      
      <p>
        </font><font size="2" face="Segoe UI">&#160;</font><font size="2" face="Segoe UI">&#160; </font>
      </p>
      
      <p align="left">
        <strong><u><font size="4" face="Segoe UI">Searching for specific HTTP Response Code:</font></u></strong>
      </p>
      
      <p>
        <font size="2" face="Segoe UI"> </p> 
        
        <table cellspacing="0" cellpadding="2" width="600" border="1">
          <tr>
            <td valign="top" width="600">
              <p align="left">
                <font face="Courier New">LOGPARSER "SELECT count(*) as hits, sc-status, cs-uri-stem&#160; from <strong><font color="#ff0000"><Log File Path></font></strong> where sc-status=404 GROUP BY cs-uri-stem, sc-status order by hits desc" -i:IISW3C -o:DataGrid -q:off</font>
              </p>
            </td>
          </tr>
        </table>
        
        <p>
          </font>
        </p>
        
        <p align="left">
          <strong><u><font size="4" face="Segoe UI">Counting the No. of file extensions requested:</font></u></strong>
        </p>
        
        <p>
          <font size="2" face="Segoe UI"> </p> 
          
          <table cellspacing="0" cellpadding="2" width="600" border="1">
            <tr>
              <td valign="top" width="600">
                <p align="left">
                  <font face="Courier New">LOGPARSER "SELECT count(*) as hits from <strong><font color="#ff0000"><Log File Path></font></strong>&#160; where cs-uri-stem like &#8216;%.<file-extensions>" -i:IISW3C -o:DataGrid -q:off</font>
                </p>
              </td>
            </tr>
          </table>
          
          <p>
            </font>
          </p>
          
          <p>
            <strong><u><font size="4" face="Segoe UI">Dumping out details for a specific file type:</font></u></strong>
          </p>
          
          <p>
            <font size="2" face="Segoe UI"> </p> 
            
            <table cellspacing="0" cellpadding="2" width="600" border="1">
              <tr>
                <td valign="top" width="600">
                  <p align="left">
                    <font face="Courier New">LOGPARSER "SELECT count(*) as hits, cs-uri-stem from <strong><font color="#ff0000"><Log File Path></font></strong> where cs-uri-stem like &#8216;<strong>%.<file-extensions></strong>&#8216; GROUP BY cs-uri-stem order by hits desc" -i:IISW3C -o:DataGrid -q:off</font>
                  </p>
                </td>
              </tr>
              
              <tr>
                <td valign="top" width="600">
                  In the above command replace <file-extensions> with a one that you are searching for like &#8216;”.asp”, “.aspx”, “.php” etc
                </td>
              </tr>
            </table>
            
            <p>
              </font><font size="2" face="Segoe UI">&#160;</font><font size="2" face="Segoe UI">&#160; </font>
            </p>
            
            <p>
              <font face="Segoe UI"><font size="2"><strong>NOTE</strong>: Replace <font color="#ff0000"><strong><Log File Path></strong></font> with the location where the log files are store. </font></font><font face="Segoe UI"><font size="2">Assuming they are stored at location: <strong>C:\Logs. </strong>H</font></font><font face="Segoe UI"><font size="2">ere is one e.g.: </font></font>
            </p>
            
            <p>
              <font face="Segoe UI"><font size="2"><strong><font style="background-color: rgb(204, 204, 204);" color="#000000">LOGPARSER "SELECT count(*) as hits from C:\Logs\ex101003" -i:IISW3C -o:DataGrid -q:off</font></strong></font></font>
            </p>
            
            <p>
              <font size="2" face="Segoe UI"></font>
            </p>
            
            <p>
              <font size="2" face="Segoe UI">Alternatively, you can run this query on all the files within the folder using a wild-card:</font>
            </p>
            
            <p>
              <font face="Segoe UI"><font size="2"><strong><font style="background-color: rgb(204, 204, 204);" color="#000000">LOGPARSER "SELECT count(*) as hits from C:\Logs\ex*" -i:IISW3C -o:DataGrid -q:off</font></strong></font></font>
            </p>
            
            <p>
              <font size="2" face="Segoe UI">As you can see we can write more flexible queries to extract further information.</font>
            </p>
            
            <p>
              <font size="2" face="Segoe UI">I will be publishing more in future when I get time.</font>
            </p>
            
            <p>
              <font size="2" face="Segoe UI"></font>
            </p>
            
            <p>
              <strong></strong>
            </p>
            
            <p>
              <font size="2" face="Segoe UI"></font>
            </p>
            
            <p>
              <strong><font size="4" face="Segoe UI"><u>More Information:</u></font></strong>
            </p>
            
            <p>
              <font face="Segoe UI"><font size="2"><strong>Log Parser Forum</strong>: </font><a title="http://forums.iis.net/default.aspx?GroupID=51" href="http://forums.iis.net/default.aspx?GroupID=51"><font size="2">http://forums.iis.net/default.aspx?GroupID=51</font></a><font size="2">&#160; </font></font>
            </p>
            
            <p>
              <font face="Segoe UI"><font size="2"><strong>KB Article on Log Parser</strong>: </font></font><a href="http://support.microsoft.com/kb/910447"><font size="2" face="Segoe UI">http://support.microsoft.com/kb/910447</font></a><font size="2" face="Segoe UI">.</font>
            </p>
            
            <p>
              <font face="Segoe UI"><font size="2"><strong>More on Log Parser by Rahul Soni</strong>: </font></font><a title="http://blogs.msdn.com/b/rahulso/archive/category/14624.aspx" href="http://blogs.msdn.com/b/rahulso/archive/category/14624.aspx"><font size="2" face="Segoe UI">http://blogs.msdn.com/b/rahulso/archive/category/14624.aspx</font></a>
            </p>
            
            <p>
              <font size="2" face="Segoe UI"><strong>Log Parser Examples</strong>: <a title="http://technet.microsoft.com/en-us/library/ee692659.aspx" href="http://technet.microsoft.com/en-us/library/ee692659.aspx">http://technet.microsoft.com/en-us/library/ee692659.aspx</a></font>
            </p>
            
            <p>
              <font size="2" face="Segoe UI"><strong>Forensic Log Parsing with Microsoft’s Log Parser</strong>: <a title="http://www.symantec.com/connect/articles/forensic-log-parsing-microsofts-logparser" href="http://www.symantec.com/connect/articles/forensic-log-parsing-microsofts-logparser">http://www.symantec.com/connect/articles/forensic-log-parsing-microsofts-logparser</a></font>
            </p>