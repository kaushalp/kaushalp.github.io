---
id: 32
title: Taming the Beast (Browser Exploit Against SSL/TLS)
date: 2011-10-03T06:38:00+00:00
author: kaushal
layout: post
guid: https://blogs.msdn.microsoft.com/kaushal/2011/10/03/taming-the-beast-browser-exploit-against-ssltls/
permalink: /2011/10/03/taming-the-beast-browser-exploit-against-ssltls/
orig_url:
  - http://blogs.msdn.microsoft.com/b/kaushal/archive/2011/10/03/taming-the-beast-browser-exploit-against-ssl-tls.aspx
  - http://blogs.msdn.microsoft.com/b/kaushal/archive/2011/10/03/taming-the-beast-browser-exploit-against-ssl-tls.aspx
  - http://blogs.msdn.microsoft.com/b/kaushal/archive/2011/10/03/taming-the-beast-browser-exploit-against-ssl-tls.aspx
orig_site_id:
  - "13803"
  - "13803"
  - "13803"
orig_post_id:
  - "10219079"
  - "10219079"
  - "10219079"
orig_parent_id:
  - "10219079"
  - "10219079"
  - "10219079"
orig_application_key:
  - kaushal
  - kaushal
  - kaushal
orig_post_author_id:
  - "213737"
  - "213737"
  - "213737"
orig_post_author_username:
  - djkaushal
  - djkaushal
  - djkaushal
orig_post_author_created:
  - 2009-07-24 14:00:49.000
  - 2009-07-24 14:00:49.000
  - 2009-07-24 14:00:49.000
orig_is_approved:
  - "1"
  - "1"
  - "1"
orig_url_title:
  - http://blogs.msdn.com/b/kaushal/archive/2011/10/03/taming-the-beast-browser-exploit-against-ssltls.aspx
  - http://blogs.msdn.com/b/kaushal/archive/2011/10/03/taming-the-beast-browser-exploit-against-ssltls.aspx
  - http://blogs.msdn.com/b/kaushal/archive/2011/10/03/taming-the-beast-browser-exploit-against-ssltls.aspx
orig_post_name:
  - taming the beast browser exploit against ssl tls
  - taming the beast browser exploit against ssl tls
  - taming the beast browser exploit against ssl tls
orig_thread_id:
  - "782959"
  - "782959"
  - "782959"
orig_post_author_email:
  - kaushalp@microsoft.com
  - kaushalp@microsoft.com
  - kaushalp@microsoft.com
orig_attachment_count:
  - "0"
  - "0"
  - "0"
total_views:
  - "96357"
  - "96357"
  - "96357"
opengraph_tags:
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Taming the Beast (Browser Exploit Against SSL/TLS)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/kaushal/2011/10/03/taming-the-beast-browser-exploit-against-ssltls/" />
    <meta property="og:site_name" content="Unleashed" />
    <meta property="og:description" content="Two researchers recently discovered a known vulnerability that existed in CBC based ciphers, but was considered theoretically impractical, until then. This vulnerability exists in all CBC based ciphers used in SSL V3/TLS 1.0. The researchers Juliano Rizzo and Thai Duong demonstrated proof-of-concept code called BEAST (Browser Exploit Against SSL/TLS) at the Ekoparty security conference held..." />
    <meta property="og:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/8625.wlEmoticon-smile_2E368FEE.png" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Taming the Beast (Browser Exploit Against SSL/TLS)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/kaushal/2011/10/03/taming-the-beast-browser-exploit-against-ssltls/" />
    <meta name="twitter:description" content="Two researchers recently discovered a known vulnerability that existed in CBC based ciphers, but was considered theoretically impractical, until then. This vulnerability exists in all CBC based ciphers used in SSL V3/TLS 1.0. The researchers Juliano Rizzo and Thai Duong demonstrated proof-of-concept code called BEAST (Browser Exploit Against SSL/TLS) at the Ekoparty security conference held..." />
    <meta name="twitter:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/8625.wlEmoticon-smile_2E368FEE.png" />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Taming the Beast (Browser Exploit Against SSL/TLS)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/kaushal/2011/10/03/taming-the-beast-browser-exploit-against-ssltls/" />
    <meta property="og:site_name" content="Unleashed" />
    <meta property="og:description" content="Two researchers recently discovered a known vulnerability that existed in CBC based ciphers, but was considered theoretically impractical, until then. This vulnerability exists in all CBC based ciphers used in SSL V3/TLS 1.0. The researchers Juliano Rizzo and Thai Duong demonstrated proof-of-concept code called BEAST (Browser Exploit Against SSL/TLS) at the Ekoparty security conference held..." />
    <meta property="og:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/8625.wlEmoticon-smile_2E368FEE.png" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Taming the Beast (Browser Exploit Against SSL/TLS)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/kaushal/2011/10/03/taming-the-beast-browser-exploit-against-ssltls/" />
    <meta name="twitter:description" content="Two researchers recently discovered a known vulnerability that existed in CBC based ciphers, but was considered theoretically impractical, until then. This vulnerability exists in all CBC based ciphers used in SSL V3/TLS 1.0. The researchers Juliano Rizzo and Thai Duong demonstrated proof-of-concept code called BEAST (Browser Exploit Against SSL/TLS) at the Ekoparty security conference held..." />
    <meta name="twitter:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/8625.wlEmoticon-smile_2E368FEE.png" />
    
  - |
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Taming the Beast (Browser Exploit Against SSL/TLS)" />
    <meta property="og:url" content="https://blogs.msdn.microsoft.com/kaushal/2011/10/03/taming-the-beast-browser-exploit-against-ssltls/" />
    <meta property="og:site_name" content="Unleashed" />
    <meta property="og:description" content="Two researchers recently discovered a known vulnerability that existed in CBC based ciphers, but was considered theoretically impractical, until then. This vulnerability exists in all CBC based ciphers used in SSL V3/TLS 1.0. The researchers Juliano Rizzo and Thai Duong demonstrated proof-of-concept code called BEAST (Browser Exploit Against SSL/TLS) at the Ekoparty security conference held..." />
    <meta property="og:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/8625.wlEmoticon-smile_2E368FEE.png" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Taming the Beast (Browser Exploit Against SSL/TLS)" />
    <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/kaushal/2011/10/03/taming-the-beast-browser-exploit-against-ssltls/" />
    <meta name="twitter:description" content="Two researchers recently discovered a known vulnerability that existed in CBC based ciphers, but was considered theoretically impractical, until then. This vulnerability exists in all CBC based ciphers used in SSL V3/TLS 1.0. The researchers Juliano Rizzo and Thai Duong demonstrated proof-of-concept code called BEAST (Browser Exploit Against SSL/TLS) at the Ekoparty security conference held..." />
    <meta name="twitter:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/8625.wlEmoticon-smile_2E368FEE.png" />
    
categories:
  - Uncategorized
tags:
  - BEAST
  - SSL
  - TLS
---
<p align="justify">
  <font size="2" face="Calibri">Two researchers recently discovered a known vulnerability that existed in CBC based ciphers, but was considered theoretically impractical, until then. This vulnerability exists in all CBC based ciphers used in <strong>SSL V3/TLS 1.0</strong>. The researchers <b>Juliano Rizzo</b> and <b>Thai Duong demonstrated </b>proof-of-concept code called <font color="#ff0000"><b>BEAST </b>(<b>Browser Exploit Against SSL/TLS</b>)</font> at the </font><a href="http://www.ekoparty.org/"><font size="2" face="Calibri">Ekoparty security conference</font></a><font size="2" face="Calibri"> held in late September, 2011.</font>
</p>

<p align="justify">
  <font size="2" face="Calibri">If you don’t remember, these 2 are the same guys who last year discovered the “<b><font color="#ff0000">Padding Oracle</font></b>” crypto attack in <strong>ASP.NET</strong>. <img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/8625.wlEmoticon-smile_2E368FEE.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/8625.wlEmoticon_2D00_smile_5F00_2E368FEE.png" /></font>
</p>

<p align="justify">
  <font size="2" face="Calibri">I will try to be as explanatory as possible. One of the researchers (<strong>Thai Duong</strong>) has published this on his blog here: </font><a href="http://vnhacker.blogspot.com/2011/09/beast.html"><font size="2" face="Calibri">http://vnhacker.blogspot.com/2011/09/beast.html</font></a><font size="2" face="Calibri">. This blog contains a video link demonstrating the attack.</font>
</p>

<p align="justify">
  <font size="2" face="Calibri">After this Microsoft released a Security Advisory article and a HOTFIX addressing the vulnerability on 26<sup>th</sup> September 2011. </p> 
  
  <p>
    </font><a href="http://technet.microsoft.com/en-us/security/advisory/2588513"><font size="2" face="Calibri">http://technet.microsoft.com/en-us/security/advisory/2588513</font></a><font size="2" face="Calibri"> <br /></font><a href="http://support.microsoft.com/kb/2588513"><font size="2" face="Calibri">http://support.microsoft.com/kb/2588513</font></a>
  </p>
  
  <p align="center">
    <b><u><font size="4" face="Calibri">INTRODUCTION</font></u></b>
  </p>
  
  <p align="justify">
    <font size="2" face="Calibri">Now, before we proceed ahead, we need to understand few semantics of <strong>SSL</strong> in order to understand this vulnerability. As I aforementioned, this vulnerability exists in all CBC based ciphers used in <strong>SSL V3/TLS 1.0</strong>.</font>
  </p>
  
  <p align="justify">
    <font size="2" face="Calibri">I also want to mention that I referred few things from internet, mostly from Wikipedia, and what I remember from my college days. I am glad I was one of the few that opted for Cryptography as one of the topics back in my engineering days. <img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/7870.wlEmoticon-smile_14586983.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/7870.wlEmoticon_2D00_smile_5F00_14586983.png" /></font>
  </p>
  
  <p align="justify">
    <font size="2"><font face="Calibri"><b><u><font size="3">SSL Protocol</font>:</u></b> These are the following list of protocols which have been released till date:</font></font>
  </p>
  
  <ul>
    <li>
      <div align="justify">
        <font size="2"><font face="Calibri"><b>SSL 1.0, 2.0 and 3.0</b> </font></font>
      </div>
    </li>
    
    <li>
      <div align="justify">
        <font size="2"><font face="Calibri"><b>TLS 1.0</b> (or SSL 3.1, released in 1999) </font></font>
      </div>
    </li>
    
    <li>
      <div align="justify">
        <font size="2"><font face="Calibri"><b>TLS 1.1 </b>(or SSL 3.2, released in 2006) </font></font>
      </div>
    </li>
    
    <li>
      <div align="justify">
        <font size="2"><font face="Calibri"><b>TLS 1.2 </b>(or SSL 3.3, released in 2008) </font></font>
      </div>
    </li>
  </ul>
  
  <p align="justify">
    <font size="2"><font face="Calibri"><b>NOTE: </b>Windows Server 2008 R2 and Windows 7 are the only 2 OS which support TLS 1.1 and TLS 1.2 as of now. All the OS’s before this don’t support these 2 protocols.</font></font>
  </p>
  
  <p align="justify">
    <font size="2" face="Calibri">Please refer the following blog post by me on support for SSL/TLS protocols on Windows. <br /></font><a href="http://blogs.msdn.com/b/kaushal/archive/2011/10/02/10218922.aspx"><font size="2" face="Calibri">http://blogs.msdn.com/b/kaushal/archive/2011/10/02/10218922.aspx</font></a>
  </p>
  
  <p align="justify">
    <b><u><font size="2" face="Calibri"></font></u></b>
  </p>
  
  <p align="justify">
    <font size="2"><font face="Calibri"><b><u><font size="3">CIPHERS</font></u></b>: Ciphers are cryptographic algorithms used for performing encryption/decryption. A “<b>Plain text</b>” is fed as input to CIPHERS to generate an encrypted text also known as “<b>Cipher text</b>”. There are 2 kinds of Ciphers generally used during SSL handshake:</font></font>
  </p>
  
  <ul>
    <li>
      <div align="justify">
        <font size="2"><font face="Calibri"><b>Block Ciphers, like AES and DES</b> </font></font>
      </div>
    </li>
    
    <li>
      <div align="justify">
        <font size="2"><font face="Calibri"><b>Stream Ciphers, like RC4</b> </font></font>
      </div>
    </li>
  </ul>
  
  <p align="justify">
    <font size="2"><font face="Calibri"><b><u><font size="4">CBC (Cipher-block chaining)</font></u></b><u>:</u> It is a symmetric key algorithm, used for encryption/decryption. It is also referred as a block cipher. It firsts partitions the input message into separate cipher blocks of equal length. The nth or the last block sometimes may have to be padded to match the cipher’s block length. Now these blocks are encrypted one at a time.</font></font>
  </p>
  
  <p align="justify">
    <font size="2" face="Calibri">In CBC, the plain text is <b>XOR</b>’d with the <b>Initialization vector</b> (<b>IV</b>) in the first block and with the cipher texts of the previous blocks before undergoing encryption. The IV is generally sued to make each message unique. Here is where the problem arises. I will explain this in the later section.</font>
  </p>
  
  <p align="justify">
    <font size="2" face="Calibri">The below images below explain the encryption/decryption. The images from articles on </font><a href="http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation">Wikipedia</a><font size="2" face="Calibri"></font><font size="2" face="Calibri"> helped me draw out these images in a colorful way, however they lacked continuity. So I used few dotted lines to indicate continuation of cipher operations.</font>
  </p>
  
  <p align="justify">
    <font size="2" face="Calibri">The dotted lines below indicate continuity from 1st and second blocks to the nth block and vice-versa.</font>
  </p>
  
  <p align="center">
    <a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/5001.clip_image001_58A2C10B.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/5001.clip_5F00_image001_5F00_58A2C10B.png"><font size="2" face="Calibri"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="clip_image001" border="0" alt="clip_image001" src="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/6165.clip_image001_thumb_7CE7A58D.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/6165.clip_5F00_image001_5F00_thumb_5F00_7CE7A58D.png" width="587" height="206" /></font></a><font size="2" face="Calibri"> <br /></font><b><u> <br /><font size="2" face="Calibri">Encryption in CBC Mode <br /></font></u></b><b><font size="2" face="Calibri"><u>Courtesy</u>:&#160; <a title="http://en.wikipedia.org/wiki/File:Cbc_encryption.png" href="http://en.wikipedia.org/wiki/File:Cbc_encryption.png">http://en.wikipedia.org/wiki/File:Cbc_encryption.png</a> <br /></font></b>
  </p>
  
  <p>
    <b><u></u></b>
  </p>
  
  <p align="center">
    <b><u><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/2845.clip_image003_20C0571B.jpg" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/2845.clip_5F00_image003_5F00_20C0571B.jpg"><font size="2" face="Calibri"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="clip_image003" border="0" alt="clip_image003" src="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/2450.clip_image003_thumb_5E010BE2.jpg" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/2450.clip_5F00_image003_5F00_thumb_5F00_5E010BE2.jpg" width="592" height="183" /></font></a></u></b>
  </p>
  
  <p>
    <b><u></u></b>
  </p>
  
  <p align="center">
    <b><u><font size="2" face="Calibri">Decryption in CBC Mode <br /></font></u></b><strong><font size="2" face="Calibri"><u>Courtesy</u>: <a title="http://en.wikipedia.org/wiki/File:Cbc_decryption.png" href="http://en.wikipedia.org/wiki/File:Cbc_decryption.png">http://en.wikipedia.org/wiki/File:Cbc_decryption.png</a>&#160;</font></strong>
  </p>
  
  <p align="center">
    <b><u><font size="2" face="Calibri"></font></u></b>
  </p>
  
  <p align="justify">
    <font size="2"><font face="Calibri"><b><u><font size="3">SSL Handshake</font></u></b><b>: </b>SSL handshake is too big of a topic to be discussed here. Anyways we don’t need to discuss the complete handshake, What we need to know is, the 2 communicating entities, <strong>client</strong> and the <strong>server</strong>, decide on a common <b>SSL/TLS</b> protocol and cipher (<b>Block Ciphers or Stream Ciphers</b>) that they will be used to perform the encryption/decryption. The public key cryptography is used to decide these and during the latter part of the handshake, they decide on symmetric keys and perform encryption/decryption using the generated symmetric key and the ciphers decided earlier.</font></font>
  </p>
  
  <p align="justify">
    <font size="2" face="Calibri">I invested some time and chalked out the image below. This explains the SSL handshake between client and server. This in reference to the <a href="http://support.microsoft.com/kb/257591">Microsoft KB article 257951</a> on SSL handshake.</font>
  </p>
  
  <p align="justify">
    <a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/3835.image_622AE3A7.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/3835.image_5F00_622AE3A7.png"><font size="2" face="Calibri"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/8306.image_thumb_62D399D1.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/8306.image_5F00_thumb_5F00_62D399D1.png" width="619" height="606" /></font></a>
  </p>
  
  <p align="justify">
    <font size="2"><font face="Calibri"><b><u><font size="3">Chosen Plain-text recovery attack</font></u></b><b>: </b></font></font>
  </p>
  
  <p align="justify">
    <font size="2" face="Calibri">One of the methods used by the attackers, in order to gain access to the secret key being used by the communicating entities involved in a SSL handshake. In this method, the attacker choses arbitrary plain-texts and obtains corresponding cipher texts. The attacker makes predictive guesses depending upon the obtained cipher text, to form the original plain text.</font>
  </p>
  
  <p align="justify">
    <font size="2" face="Calibri">This sounds unrealistic, as the attacker has to make predictions in order to crack it. However, modern day cryptography has become lot more easier as there are powerful hardware and software, capable of performing millions of calculations per second. </font>
  </p>
  
  <p align="center">
    <b><u><font size="4" face="Calibri">BEAST: Discussing the vulnerability</font></u></b>
  </p>
  
  <p align="justify">
    <font size="2" face="Calibri">Remember the use of implicit IV’s while XOR’ing the plain text for successive blocks after the first block. This was a problem. The thing is that IV’s are supposed to be unique. Since the cipher text of the previous block is used as an IV in the current block mode of operation, the uniqueness is actually lost, and as I know that my previous cipher text is the IV for the current block.</font>
  </p>
  
  <ul>
    <li>
      <div align="justify">
        <font size="2" face="Calibri">This vulnerability was addressed in <b>TLS 1.1</b> and <b>TLS 1.2</b>, by usage of “<b>Explicit IV’s</b>” for each block. Hence, <b>TLS 1.1</b> and <b>TLS 1.2</b> are not susceptible to this attack. I will once again emphasize on the fact that this vulnerability is seen only in CBC based Ciphers like <b>AES</b>, <b>DES</b> and <b>Triple DES</b>. <br /></font>
      </div>
    </li>
    
    <li>
      <div align="justify">
        <font size="2"><font face="Calibri"><strong>OPENSSL</strong> addressed this in TLS 1.0 by inserting TLS packets with <strong>zero-length</strong> payloads and random padding. However, this solution is disabled by default due to incompatibility with certain SSL stacks. <br /></font></font>
      </div>
    </li>
    
    <li>
      <div align="justify">
        <font size="2" face="Calibri">I’m not going to discuss how the attack works, please refer the blog article by one of the researchers: </font><a href="http://vnhacker.blogspot.com/2011/09/beast.html"><font size="2" face="Calibri">http://vnhacker.blogspot.com/2011/09/beast.html</font></a><font size="2" face="Calibri">. They use the <b>Chosen plain text recovery attack</b>, a known attack which was considered to be theoretically impossible until they cracked it. <br /></font>
      </div>
    </li>
    
    <li>
      <div align="justify">
        <font size="2" face="Calibri">There are few catches here: </font>
      </div>
      
      <ul>
        <li>
          <div align="justify">
            <font size="2" face="Calibri">This attack is not easily implemented. It cannot be cracked by just observing the encrypted traffic.</font>
          </div>
        </li>
        
        <li>
          <div align="justify">
            <font size="2" face="Calibri">The attacker should know in prior which&#160; secure site is being browsed.</font>
          </div>
        </li>
        
        <li>
          <div align="justify">
            <font size="2" face="Calibri">The attacker has to implement a <b>Man-in-the-Middle</b> attack in order to do this. So the attacker has to be within the same network where this attack has to be implemented. </font>
          </div>
        </li>
        
        <li>
          <div align="justify">
            <font size="2" face="Calibri">Multiple requests have to be sent across the wire before he could crack it i.e., he has to mix his traffic with the SSL traffic that the entities are communicating to each other without either of them realizing it. </font>
          </div>
        </li>
        
        <li>
          <div align="justify">
            <font size="2" face="Calibri">This only lets the attacker to guess one plain text block at a time. </font>
          </div>
        </li>
      </ul>
    </li>
  </ul>
  
  <p align="center">
    <b><u><font size="4" face="Calibri">Workaround/Solutions</font></u></b>
  </p>
  
  <p align="justify">
    <b><u><font size="3" face="Calibri">Server Side Fix:</font></u></b>
  </p>
  
  <ol>
    <li>
      <div align="justify">
        <font size="2"><font face="Calibri">Prioritize the RC4 cipher suites rather than CB. RC4 is a stream cipher, since the attack is effective against CBC based Ciphers. <br /><b><u></u></b></font></font>
      </div>
      
      <ul>
        <li>
          <div align="justify">
            <font size="2" face="Calibri">Go to Start, click on run and type “<strong>gpedit.msc</strong>”. </font>
          </div>
        </li>
        
        <li>
          <div align="justify">
            <font size="2" face="Calibri">Go to Local Computer Policy &#8211;> Administrative Templates &#8211;> Network &#8211;> SSL Configuration Settings </font>
          </div>
        </li>
        
        <li>
          <div align="justify">
            <font size="2" face="Calibri">Move “<strong><font style="background-color: #00ff00">TLS_RSA_WITH_RC4_128_SHA</font></strong>” to the top of the priority list. The GUI suggests how to modify the settings. </p> 
            
            <p>
              How to modify this setting: <br /></font></div> 
              
              <ul>
                <li>
                  <div align="justify">
                    <font size="2" face="Calibri">Open a blank notepad document. </font>
                  </div>
                </li>
                
                <li>
                  <div align="justify">
                    <font size="2" face="Calibri">Copy and paste the list of available suites into it. </font>
                  </div>
                </li>
                
                <li>
                  <div align="justify">
                    <font size="2" face="Calibri">Arrange the suites in the correct order; remove any suites you don&#8217;t want to use. </font>
                  </div>
                </li>
                
                <li>
                  <div align="justify">
                    <font size="2" face="Calibri">Place a comma at the end of every suite name except the last. Make sure there are NO embedded spaces. </font>
                  </div>
                </li>
                
                <li>
                  <div align="justify">
                    <font size="2" face="Calibri">Remove all the line breaks so that the cipher suite names are on a single, long line. </font>
                  </div>
                </li>
                
                <li>
                  <div align="justify">
                    <font size="2" face="Calibri">Copy the cipher-suite line to the clipboard, and then paste it into the edit box. <font style="background-color: #ff0000"><font color="#ffffff">The maximum length is 1023 characters</font>.</font> <br /></font>
                  </div>
                </li>
              </ul></li> </ul> </li> 
              
              <li>
                <div align="justify">
                  <font size="2" face="Calibri">Enable <b>TLS 1.1</b> and/or <b>TLS 1.2</b> on servers running Windows 7 or Windows Server 2008 R2. Refer Microsoft Knowledge Base Article </font><a href="http://support.microsoft.com/kb/2588513"><font size="2" face="Calibri">2588513</font></a><font size="2" face="Calibri"> to use the automated Microsoft Fix it solution to enable or disable this workaround for TLS 1.1. </font>
                </div>
              </li></ol> 
              
              <p align="justify">
                <font size="2"><font face="Calibri"><b><font color="#ff0000">Warning</font></b><b>:</b> <font style="background-color: #ffff00"><i>Web clients that don’t support TLS 1.1 or 1.2 will perform the SSL negotiation with lower SSL/TLS versions, voiding the workaround. So better implement both the workarounds on</i><i> IIS 7.5.</i><i></i></font></font></font>
              </p>
              
              <p align="justify">
                <font size="2" face="Calibri">The above KB article adds the following registry key when run on server side:</font>
              </p>
              
              <p align="justify">
                <a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/5076.image_6BFFAF45.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/5076.image_5F00_6BFFAF45.png"><font size="2" face="Calibri"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/1778.image_thumb_62C37404.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/1778.image_5F00_thumb_5F00_62C37404.png" width="608" height="159" /></font></a>
              </p>
              
              <p align="justify">
                <font size="2"><font face="Calibri"><b>NOTE: </b><em><font style="background-color: #ffff00">Unfortunately the above solution doesn’t apply to <b>Windows Server 2003/Windows XP</b></font><font style="background-color: #ffff00">, the cipher suites prority is hard coded. On Windows Server 2003, they will probably have to disable the CBC based ciphers; however this might cause incompatibility with clients trying to connect to these servers.</font></em></font></font><em><font size="2" face="Calibri"> <br /></font></em>
              </p>
              
              <p align="justify">
                <font size="2" face="Calibri"></font>
              </p>
              
              <p align="justify">
                <b><u> <br /><font size="3" face="Calibri">Browser Side Fix:</font></u></b>
              </p>
              
              <p align="justify">
                <font size="2" face="Calibri">Among browsers as of now only 2 of them include support for TLS 1.1 and TLS 1.2</font>
              </p>
              
              <ul>
                <li>
                  <div align="justify">
                    <font size="2"><font face="Calibri"><b>IE 8/IE 9</b>, running on <b>Windows 7</b> or <b>Windows Server 2008 R2</b>. </font></font>
                  </div>
                </li>
                
                <li>
                  <div align="justify">
                    <font size="2" face="Calibri">Opera V10 onwards. </font>
                  </div>
                </li>
              </ul>
              
              <p align="justify">
                <font size="2"><font face="Calibri"><strong>IE</strong>, like <strong>IIS</strong> relies on <strong>SCHANNEL</strong> for encryption or decryption, hence it supports only those protocols that are supported by the underlying OS. However, this is not true for non-Microsoft products; they have their own implementation and include support for these protocols specifically.</font></font>
              </p>
              
              <ol>
                <li>
                  <div align="justify">
                    <font size="2" face="Calibri">Enable TLS 1.1 and/or 1.2 in Internet Explorer on systems running Windows 7 or Windows Server 2008 R2. To change the default protocol version to be used for HTTPS requests, perform the following steps: </p> 
                    
                    <p>
                      </font></div> 
                      
                      <ul>
                        <li>
                          <div align="justify">
                            <font size="2" face="Calibri">On the Internet Explorer Tools menu, click Internet Options. </font>
                          </div>
                        </li>
                        
                        <li>
                          <div align="justify">
                            <font size="2" face="Calibri">In the Internet Options dialog box, click the “<b>Advanced”</b> tab and scroll to the bottom. </font>
                          </div>
                        </li>
                        
                        <li>
                          <div align="justify">
                            <font size="2" face="Calibri">In the <b>Security</b> category, select the Use TLS 1.1 and/or Use TLS 1.2 checkboxes. </font>
                          </div>
                        </li>
                        
                        <li>
                          <div align="justify">
                            <font size="2" face="Calibri">Click OK. </font>
                          </div>
                        </li>
                        
                        <li>
                          <div align="justify">
                            <font size="2" face="Calibri">Exit and restart Internet Explorer. </font>
                          </div>
                        </li>
                      </ul>
                      
                      <p>
                        <b> </p> 
                        
                        <div align="justify">
                          <font size="2"><font face="Calibri">Note: <i>See Microsoft Knowledge Base Article <a href="http://support.microsoft.com/kb/2588513">2588513</a> to use the automated Microsoft Fix it solution to enable or disable this workaround for TLS 1.1.</i></font></font>
                        </div>
                        
                        <p>
                          <font size="2"><font face="Calibri"><b><font color="#ff0000">Warning</font></b><b>:</b> <i><font style="background-color: #ffff00">Web servers that don’t support TLS 1.1 or 1.2 will perform the SSL negotiation with lower SSL/TLS versions, voiding the workaround.</font></i></font></font><font size="2" face="Calibri"> <br /></font></b></li> 
                          
                          <li>
                            <div align="justify">
                              <font size="2" face="Calibri">Set Internet and Local intranet security zone settings to "<b>High</b>" to block ActiveX Controls and Active Scripting in these zones. These may render many web-sites non-functional. So if you don’t want to block ActiveX Controls and Active Scripting for such sites, then add sites that you trust to the “<b>Trusted Sites Zone</b>”. <br /></font>
                            </div>
                          </li>
                          
                          <li>
                            <div align="justify">
                              <font size="2"><font face="Calibri"><b>Clear cookies and don’t navigate to HTTP and HTTPS websites at the same time. </b>First, clear all cookies. Then, while browsing close all HTTP Web sites, including sites that mix HTTP and HTTPS, before and during use of HTTPS. Finally log out of all HTTPS Web sites that require authentication before resuming the HTTP traffic. </font></font>
                            </div>
                          </li></ol> 
                          
                          <p align="justify">
                            <b><u><font face="Calibri">Recommended reading on this:</font></u></b>
                          </p>
                          
                          <ul>
                            <li>
                              <div align="justify">
                                <font size="2" face="Calibri"><b>Microsoft Security Advisory (2588513): Vulnerability in SSL/TLS Could Allow Information Disclosure <br /></b></font><a href="http://technet.microsoft.com/en-us/security/advisory/2588513"><font size="2" face="Calibri">http://technet.microsoft.com/en-us/security/advisory/2588513</font></a><font size="2" face="Calibri"> <br /></font><a href="http://support.microsoft.com/kb/2588513"><font size="2" face="Calibri">http://support.microsoft.com/kb/2588513</font></a><font size="2" face="Calibri"> <br /></font>
                              </div>
                            </li>
                            
                            <li>
                              <div align="justify">
                                <font size="2" face="Calibri"><b>Is SSL broken? – More about Security Advisory: <br /></b></font><a href="http://blogs.technet.com/b/srd/archive/2011/09/26/is-ssl-broken-more-about-security-advisory-2588513.aspx"><font size="2" face="Calibri">http://blogs.technet.com/b/srd/archive/2011/09/26/is-ssl-broken-more-about-security-advisory-2588513.aspx</font></a></a><b></b></a><font size="2" face="Calibri"> <br /></font>
                              </div>
                            </li>
                            
                            <li>
                              <div align="justify">
                                <font size="2"><font face="Calibri"><b>BEAST:</b> </font></font><a href="http://vnhacker.blogspot.com/2011/09/beast.html"><font size="2" face="Calibri">http://vnhacker.blogspot.com/2011/09/beast.html</font></a>
                              </div>
                            </li>
                          </ul>
                          
                          <p align="justify">
                            <font size="2" face="Calibri">The irony is that major internet browsers (<strong>Chrome, Firefox and Safari</strong>) still don’t provide support for TLS 1.1 and TLS 1.2. They continue to use a security protocols which is a decade old. Its been 5 years since TLS 1.1 was released, yet this hasn’t been implemented by them.</font>
                          </p>
                          
                          <p align="justify">
                            <font size="2" face="Calibri">Even OpenSSL doesn’t include support for TLS 1.1/TLS 1.2, so as a result, even Apache doesn’t support these protocols. Hopefully, they would realize the importance of security and adopt these new IETF standards.</font>
                          </p>
                          
                          <p align="justify">
                            <font size="2" face="Calibri">Its time that we move on and adapt the new security protocols. I guess the time has arrived. <img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/38/03/metablogapi/8625.wlEmoticon-smile_2E368FEE.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-38-03-metablogapi/8625.wlEmoticon_2D00_smile_5F00_2E368FEE.png" /></font>
                          </p>